<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SMT.Script.Show</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--guardedness</a> <a id="27" class="Symbol">#-}</a>

<a id="32" class="Comment">--------------------------------------------------------------------------------</a>
<a id="113" class="Comment">-- Schmitty the Solver</a>
<a id="136" class="Comment">--</a>
<a id="139" class="Comment">-- Defines `showScript`, which prints a script as an SMT query, as well as</a>
<a id="214" class="Comment">-- generating a parser which parses the output generated by the SMT solver for</a>
<a id="293" class="Comment">-- the query.</a>
<a id="307" class="Comment">--------------------------------------------------------------------------------</a>

<a id="389" class="Keyword">open</a> <a id="394" class="Keyword">import</a> <a id="401" href="SMT.Theory.Base.html" class="Module">SMT.Theory.Base</a>
<a id="417" class="Keyword">open</a> <a id="422" class="Keyword">import</a> <a id="429" href="SMT.Theory.Class.Parsable.html" class="Module">SMT.Theory.Class.Parsable</a>
<a id="455" class="Keyword">open</a> <a id="460" class="Keyword">import</a> <a id="467" href="SMT.Theory.Class.Printable.html" class="Module">SMT.Theory.Class.Printable</a>

<a id="495" class="Keyword">module</a> <a id="502" href="SMT.Script.Show.html" class="Module">SMT.Script.Show</a> <a id="518" class="Symbol">(</a><a id="519" href="SMT.Script.Show.html#519" class="Bound">theory</a> <a id="526" class="Symbol">:</a> <a id="528" href="SMT.Theory.Base.html#1730" class="Record">Theory</a><a id="534" class="Symbol">)</a> <a id="536" class="Symbol">{{</a><a id="538" href="SMT.Script.Show.html#538" class="Bound">printable</a> <a id="548" class="Symbol">:</a> <a id="550" href="SMT.Theory.Class.Printable.html#664" class="Record">Printable</a> <a id="560" href="SMT.Script.Show.html#519" class="Bound">theory</a><a id="566" class="Symbol">}}</a> <a id="569" class="Symbol">{{</a><a id="571" href="SMT.Script.Show.html#571" class="Bound">parsable</a> <a id="580" class="Symbol">:</a> <a id="582" href="SMT.Theory.Class.Parsable.html#452" class="Record">Parsable</a> <a id="591" href="SMT.Script.Show.html#519" class="Bound">theory</a><a id="597" class="Symbol">}}</a> <a id="600" class="Keyword">where</a>

<a id="607" class="Keyword">open</a> <a id="612" href="SMT.Theory.Base.html#1730" class="Module">Theory</a> <a id="619" href="SMT.Script.Show.html#519" class="Bound">theory</a>
<a id="626" class="Keyword">open</a> <a id="631" href="SMT.Theory.Class.Parsable.html#452" class="Module">Parsable</a> <a id="640" href="SMT.Script.Show.html#571" class="Bound">parsable</a>
<a id="649" class="Keyword">open</a> <a id="654" href="SMT.Theory.Class.Printable.html#664" class="Module">Printable</a> <a id="664" href="SMT.Script.Show.html#538" class="Bound">printable</a>

<a id="675" class="Keyword">open</a> <a id="680" class="Keyword">import</a> <a id="687" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="702" class="Keyword">open</a> <a id="707" class="Keyword">import</a> <a id="714" href="Codata.Musical.Stream.html" class="Module">Codata.Musical.Stream</a> <a id="736" class="Symbol">as</a> <a id="739" class="Module">Stream</a> <a id="746" class="Keyword">using</a> <a id="752" class="Symbol">(</a><a id="753" href="Codata.Musical.Stream.html#659" class="Datatype">Stream</a><a id="759" class="Symbol">)</a>
<a id="761" class="Keyword">open</a> <a id="766" class="Keyword">import</a> <a id="773" href="Data.Char.html" class="Module">Data.Char</a> <a id="783" class="Symbol">as</a> <a id="786" class="Module">Char</a> <a id="791" class="Keyword">using</a> <a id="797" class="Symbol">(</a><a id="798" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a><a id="802" class="Symbol">)</a>
<a id="804" class="Keyword">open</a> <a id="809" class="Keyword">import</a> <a id="816" href="Data.Environment.html" class="Module">Data.Environment</a> <a id="833" class="Symbol">as</a> <a id="836" class="Module">Env</a> <a id="840" class="Keyword">using</a> <a id="846" class="Symbol">(</a><a id="847" href="Data.Environment.html#360" class="Datatype">Env</a><a id="850" class="Symbol">;</a> <a id="852" href="Data.Environment.html#427" class="InductiveConstructor Operator">_∷_</a><a id="855" class="Symbol">;</a> <a id="857" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="859" class="Symbol">)</a>
<a id="861" class="Keyword">open</a> <a id="866" class="Keyword">import</a> <a id="873" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="882" class="Symbol">as</a> <a id="885" class="Module">Fin</a> <a id="889" class="Keyword">using</a> <a id="895" class="Symbol">(</a><a id="896" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a><a id="899" class="Symbol">;</a> <a id="901" href="Data.Fin.Base.html#1179" class="InductiveConstructor">suc</a><a id="904" class="Symbol">;</a> <a id="906" href="Data.Fin.Base.html#1148" class="InductiveConstructor">zero</a><a id="910" class="Symbol">)</a>
<a id="912" class="Keyword">open</a> <a id="917" class="Keyword">import</a> <a id="924" href="Data.List.html" class="Module">Data.List</a> <a id="934" class="Symbol">as</a> <a id="937" class="Module">List</a> <a id="942" class="Keyword">using</a> <a id="948" class="Symbol">(</a><a id="949" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="953" class="Symbol">;</a> <a id="955" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="958" class="Symbol">;</a> <a id="960" href="Data.List.Base.html#10383" class="InductiveConstructor">[]</a><a id="962" class="Symbol">;</a> <a id="964" href="Data.List.Base.html#5025" class="Function Operator">[_]</a><a id="967" class="Symbol">;</a> <a id="969" href="Data.List.Base.html#9934" class="Function Operator">_ʳ++_</a><a id="974" class="Symbol">;</a> <a id="976" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="980" class="Symbol">;</a> <a id="982" href="Data.List.Base.html#4864" class="Function">length</a><a id="988" class="Symbol">)</a>
<a id="990" class="Keyword">open</a> <a id="995" class="Keyword">import</a> <a id="1002" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a> <a id="1031" class="Symbol">as</a> <a id="1034" class="Module">All</a> <a id="1038" class="Keyword">using</a> <a id="1044" class="Symbol">(</a><a id="1045" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a><a id="1048" class="Symbol">;</a> <a id="1050" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">_∷_</a><a id="1053" class="Symbol">;</a> <a id="1055" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a><a id="1057" class="Symbol">)</a>
<a id="1059" class="Keyword">open</a> <a id="1064" class="Keyword">import</a> <a id="1071" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a> <a id="1100" class="Symbol">as</a> <a id="1103" class="Module">Any</a> <a id="1107" class="Keyword">using</a> <a id="1113" class="Symbol">(</a><a id="1114" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a><a id="1118" class="Symbol">;</a> <a id="1120" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a><a id="1125" class="Symbol">)</a>
<a id="1127" class="Keyword">open</a> <a id="1132" class="Keyword">import</a> <a id="1139" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="1148" class="Keyword">using</a> <a id="1154" class="Symbol">(</a><a id="1155" href="Data.Sum.Base.html#734" class="Datatype Operator">_⊎_</a><a id="1158" class="Symbol">;</a> <a id="1160" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a><a id="1164" class="Symbol">;</a> <a id="1166" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a><a id="1170" class="Symbol">)</a>
<a id="1172" class="Keyword">open</a> <a id="1177" class="Keyword">import</a> <a id="1184" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="1203" class="Symbol">as</a> <a id="1206" class="Module">List⁺</a> <a id="1212" class="Keyword">using</a> <a id="1218" class="Symbol">(</a><a id="1219" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a><a id="1224" class="Symbol">;</a> <a id="1226" href="Data.List.NonEmpty.Base.html#1125" class="InductiveConstructor Operator">_∷_</a><a id="1229" class="Symbol">)</a>
<a id="1231" class="Keyword">open</a> <a id="1236" class="Keyword">import</a> <a id="1243" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="1254" class="Symbol">as</a> <a id="1257" class="Module">Maybe</a> <a id="1263" class="Keyword">using</a> <a id="1269" class="Symbol">(</a><a id="1270" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="1275" class="Symbol">;</a> <a id="1277" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="1281" class="Symbol">;</a> <a id="1283" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="1290" class="Symbol">)</a>
<a id="1292" class="Keyword">import</a> <a id="1299" href="Data.Maybe.Categorical.html" class="Module">Data.Maybe.Categorical</a> <a id="1322" class="Symbol">as</a> <a id="1325" class="Module">MaybeCat</a>
<a id="1334" class="Keyword">open</a> <a id="1339" class="Keyword">import</a> <a id="1346" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="1355" class="Symbol">as</a> <a id="1358" class="Module">Nat</a> <a id="1362" class="Keyword">using</a> <a id="1368" class="Symbol">(</a><a id="1369" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1370" class="Symbol">;</a> <a id="1372" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="1375" class="Symbol">;</a> <a id="1377" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="1381" class="Symbol">)</a>
<a id="1383" class="Keyword">open</a> <a id="1388" class="Keyword">import</a> <a id="1395" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="1409" class="Keyword">renaming</a> <a id="1418" class="Symbol">(</a><a id="1419" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="1424" class="Symbol">to</a> <a id="1427" class="Function">showℕ</a><a id="1432" class="Symbol">)</a>
<a id="1434" class="Keyword">open</a> <a id="1439" class="Keyword">import</a> <a id="1446" href="Data.Product.html" class="Module">Data.Product</a> <a id="1459" class="Symbol">as</a> <a id="1462" class="Module">Prod</a> <a id="1467" class="Keyword">using</a> <a id="1473" class="Symbol">(</a><a id="1474" href="Data.Product.html#1369" class="Function">∃</a><a id="1475" class="Symbol">;</a> <a id="1477" href="Data.Product.html#1806" class="Function">∃-syntax</a><a id="1485" class="Symbol">;</a> <a id="1487" href="Data.Product.html#2247" class="Function Operator">-,_</a><a id="1490" class="Symbol">;</a> <a id="1492" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="1495" class="Symbol">;</a> <a id="1497" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="1500" class="Symbol">;</a> <a id="1502" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="1507" class="Symbol">;</a> <a id="1509" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="1514" class="Symbol">)</a>
<a id="1516" class="Keyword">open</a> <a id="1521" class="Keyword">import</a> <a id="1528" href="Data.String.html" class="Module">Data.String</a> <a id="1540" class="Symbol">as</a> <a id="1543" class="Module">String</a> <a id="1550" class="Keyword">using</a> <a id="1556" class="Symbol">(</a><a id="1557" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="1563" class="Symbol">)</a>
<a id="1565" class="Keyword">open</a> <a id="1570" class="Keyword">import</a> <a id="1577" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="1587" class="Symbol">as</a> <a id="1590" class="Module">Unit</a> <a id="1595" class="Keyword">using</a> <a id="1601" class="Symbol">(</a><a id="1602" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="1603" class="Symbol">)</a>
<a id="1605" class="Keyword">open</a> <a id="1610" class="Keyword">import</a> <a id="1617" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="1626" class="Symbol">as</a> <a id="1629" class="Module">Vec</a> <a id="1633" class="Keyword">using</a> <a id="1639" class="Symbol">(</a><a id="1640" href="Data.Vec.Base.html#998" class="Datatype">Vec</a><a id="1643" class="Symbol">;</a> <a id="1645" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">_∷_</a><a id="1648" class="Symbol">;</a> <a id="1650" href="Data.Vec.Base.html#1034" class="InductiveConstructor">[]</a><a id="1652" class="Symbol">)</a>
<a id="1654" class="Keyword">open</a> <a id="1659" class="Keyword">import</a> <a id="1666" href="Function.html" class="Module">Function</a> <a id="1675" class="Keyword">using</a> <a id="1681" class="Symbol">(</a><a id="1682" href="Function.Base.html#1919" class="Function Operator">_$_</a><a id="1685" class="Symbol">;</a> <a id="1687" href="Function.Base.html#4121" class="Function Operator">case_of_</a><a id="1695" class="Symbol">;</a> <a id="1697" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="1700" class="Symbol">;</a> <a id="1702" href="Function.Base.html#636" class="Function">const</a><a id="1707" class="Symbol">;</a> <a id="1709" href="Function.Base.html#1554" class="Function">flip</a><a id="1713" class="Symbol">;</a> <a id="1715" href="Function.Base.html#615" class="Function">id</a><a id="1717" class="Symbol">)</a>
<a id="1719" class="Keyword">import</a> <a id="1726" href="Function.Identity.Categorical.html" class="Module">Function.Identity.Categorical</a> <a id="1756" class="Symbol">as</a> <a id="1759" class="Module">Identity</a>
<a id="1768" class="Keyword">import</a> <a id="1775" href="Level.html" class="Module">Level</a>
<a id="1781" class="Keyword">import</a> <a id="1788" href="Reflection.html" class="Module">Reflection</a> <a id="1799" class="Symbol">as</a> <a id="1802" class="Module">Rfl</a>
<a id="1806" class="Keyword">open</a> <a id="1811" class="Keyword">import</a> <a id="1818" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1835" class="Keyword">using</a> <a id="1841" class="Symbol">(</a><a id="1842" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a><a id="1845" class="Symbol">;</a> <a id="1847" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a><a id="1849" class="Symbol">)</a>
<a id="1851" class="Keyword">open</a> <a id="1856" class="Keyword">import</a> <a id="1863" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1901" class="Keyword">using</a> <a id="1907" class="Symbol">(</a><a id="1908" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="1911" class="Symbol">;</a> <a id="1913" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1917" class="Symbol">)</a>
<a id="1919" class="Keyword">open</a> <a id="1924" class="Keyword">import</a> <a id="1931" href="SMT.Script.Base.html" class="Module">SMT.Script.Base</a> <a id="1947" href="SMT.Script.Show.html#519" class="Bound">theory</a>
<a id="1954" class="Keyword">open</a> <a id="1959" class="Keyword">import</a> <a id="1966" href="SMT.Script.Names.html" class="Module">SMT.Script.Names</a> <a id="1983" href="SMT.Script.Show.html#519" class="Bound">theory</a>
<a id="1990" class="Keyword">open</a> <a id="1995" class="Keyword">import</a> <a id="2002" href="Text.Parser.Position.html" class="Module">Text.Parser.Position</a> <a id="2023" class="Symbol">as</a> <a id="2026" class="Module">Position</a> <a id="2035" class="Keyword">using</a> <a id="2041" class="Symbol">(</a><a id="2042" href="Text.Parser.Position.html#380" class="Record">Position</a><a id="2050" class="Symbol">)</a>

<a id="2053" class="Keyword">private</a>
  <a id="2063" class="Keyword">variable</a>
    <a id="2076" href="SMT.Script.Show.html#2076" class="Generalizable">σ</a> <a id="2078" href="SMT.Script.Show.html#2078" class="Generalizable">σ′</a>    <a id="2084" class="Symbol">:</a> <a id="2086" href="SMT.Theory.Base.html#1762" class="Function">Sort</a>
    <a id="2095" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="2097" href="SMT.Script.Show.html#2097" class="Generalizable">Γ′</a> <a id="2100" href="SMT.Script.Show.html#2100" class="Generalizable">δΓ</a> <a id="2103" class="Symbol">:</a> <a id="2105" href="SMT.Script.Base.html#2388" class="Function">Ctxt</a>
    <a id="2114" href="SMT.Script.Show.html#2114" class="Generalizable">Δ</a> <a id="2116" href="SMT.Script.Show.html#2116" class="Generalizable">Δ′</a>    <a id="2122" class="Symbol">:</a> <a id="2124" href="SMT.Script.Base.html#2388" class="Function">Ctxt</a>
    <a id="2133" href="SMT.Script.Show.html#2133" class="Generalizable">Σ</a>       <a id="2141" class="Symbol">:</a> <a id="2143" href="SMT.Theory.Base.html#1159" class="Record">Signature</a> <a id="2153" href="SMT.Script.Show.html#2076" class="Generalizable">σ</a>
    <a id="2159" href="SMT.Script.Show.html#2159" class="Generalizable">Σ′</a>      <a id="2167" class="Symbol">:</a> <a id="2169" href="SMT.Theory.Base.html#1159" class="Record">Signature</a> <a id="2179" href="SMT.Script.Show.html#2078" class="Generalizable">σ′</a>
    <a id="2186" href="SMT.Script.Show.html#2186" class="Generalizable">ξ</a> <a id="2188" href="SMT.Script.Show.html#2188" class="Generalizable">ξ′</a>    <a id="2194" class="Symbol">:</a> <a id="2196" href="SMT.Script.Base.html#5523" class="Datatype">OutputType</a>
    <a id="2211" href="SMT.Script.Show.html#2211" class="Generalizable">Ξ</a> <a id="2213" href="SMT.Script.Show.html#2213" class="Generalizable">Ξ′</a> <a id="2216" href="SMT.Script.Show.html#2216" class="Generalizable">δΞ</a> <a id="2219" class="Symbol">:</a> <a id="2221" href="SMT.Script.Base.html#5617" class="Function">OutputCtxt</a>


<a id="2234" class="Comment">-- * Parsers</a>

<a id="2248" class="Keyword">module</a> <a id="2255" href="SMT.Script.Show.html#2255" class="Module">_</a> <a id="2257" class="Keyword">where</a>

  <a id="2266" class="Keyword">open</a> <a id="2271" class="Keyword">import</a> <a id="2278" href="Text.Parser.String.html" class="Module">Text.Parser.String</a>

  <a id="2300" class="Comment">-- * Variable parsers</a>

  <a id="2325" class="Comment">-- |Environment of variable parsers.</a>
  <a id="2364" href="SMT.Script.Show.html#2364" class="Function">VarParsers</a> <a id="2375" class="Symbol">:</a> <a id="2377" href="SMT.Script.Base.html#2388" class="Function">Ctxt</a> <a id="2382" class="Symbol">→</a> <a id="2384" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="2390" href="SMT.Script.Show.html#2364" class="Function">VarParsers</a> <a id="2401" class="Symbol">=</a> <a id="2403" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="2407" class="Symbol">(λ</a> <a id="2410" href="SMT.Script.Show.html#2410" class="Bound">σ</a> <a id="2412" href="SMT.Script.Show.html#2412" class="Bound">Γ</a> <a id="2414" class="Symbol">→</a> <a id="2416" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2419" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="2426" class="Symbol">((</a><a id="2428" href="SMT.Script.Show.html#2410" class="Bound">σ</a> <a id="2430" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2432" href="SMT.Script.Show.html#2412" class="Bound">Γ</a><a id="2433" class="Symbol">)</a> <a id="2435" href="SMT.Script.Base.html#2611" class="Function Operator">∋</a> <a id="2437" href="SMT.Script.Show.html#2410" class="Bound">σ</a><a id="2438" class="Symbol">)</a> <a id="2440" href="Relation.Unary.html#3359" class="Function">]</a><a id="2441" class="Symbol">)</a>

  <a id="2446" class="Comment">-- |Construct a single variable parser from an environment of variable parsers.</a>
  <a id="2528" href="SMT.Script.Show.html#2528" class="Function">mkVarParser</a> <a id="2540" class="Symbol">:</a> <a id="2542" href="SMT.Script.Show.html#2364" class="Function">VarParsers</a> <a id="2553" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="2555" class="Symbol">→</a> <a id="2557" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2560" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="2567" class="Symbol">(</a><a id="2568" href="Data.Product.html#1806" class="Function">∃[</a> <a id="2571" href="SMT.Script.Show.html#2571" class="Bound">σ</a> <a id="2573" href="Data.Product.html#1806" class="Function">]</a> <a id="2575" class="Symbol">(</a><a id="2576" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="2578" href="SMT.Script.Base.html#2611" class="Function Operator">∋</a> <a id="2580" href="SMT.Script.Show.html#2571" class="Bound">σ</a><a id="2581" class="Symbol">))</a> <a id="2584" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="2588" href="SMT.Script.Show.html#2528" class="Function">mkVarParser</a> <a id="2600" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>            <a id="2614" class="Symbol">=</a> <a id="2616" href="Text.Parser.html#3882" class="Function">fail</a>
  <a id="2623" href="SMT.Script.Show.html#2528" class="Function">mkVarParser</a> <a id="2635" class="Symbol">(</a><a id="2636" href="SMT.Script.Show.html#2636" class="Bound">p</a> <a id="2638" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="2640" href="SMT.Script.Show.html#2640" class="Bound">env</a><a id="2643" class="Symbol">)</a> <a id="2645" class="Symbol">{</a><a id="2646" href="SMT.Script.Show.html#2646" class="Bound">x</a><a id="2647" class="Symbol">}</a> <a id="2649" class="Symbol">=</a> <a id="2651" class="Symbol">(</a><a id="2652" href="Data.Product.html#2247" class="Function Operator">-,_</a> <a id="2656" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="2660" href="SMT.Script.Show.html#2636" class="Bound">p</a> <a id="2662" class="Symbol">{</a><a id="2663" href="SMT.Script.Show.html#2646" class="Bound">x</a><a id="2664" class="Symbol">})</a> <a id="2667" href="Text.Parser.html#3943" class="Function Operator">&lt;|&gt;</a> <a id="2671" class="Symbol">(</a><a id="2672" href="Data.Product.html#2486" class="Function">Prod.map</a> <a id="2681" href="Function.Base.html#615" class="Function">id</a> <a id="2684" href="SMT.Script.Base.html#2660" class="Function">extendVar</a> <a id="2694" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="2698" href="SMT.Script.Show.html#2528" class="Function">mkVarParser</a> <a id="2710" href="SMT.Script.Show.html#2640" class="Bound">env</a> <a id="2714" class="Symbol">{</a><a id="2715" href="SMT.Script.Show.html#2646" class="Bound">x</a><a id="2716" class="Symbol">})</a>


  <a id="2723" class="Comment">-- * Output parsers</a>

  <a id="2746" class="Comment">-- |Mapping from output types to parser types.</a>
  <a id="2795" href="SMT.Script.Show.html#2795" class="Function">OutputParser</a> <a id="2808" class="Symbol">:</a> <a id="2810" href="SMT.Script.Base.html#5523" class="Datatype">OutputType</a> <a id="2821" class="Symbol">→</a> <a id="2823" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="2829" href="SMT.Script.Show.html#2795" class="Function">OutputParser</a> <a id="2842" href="SMT.Script.Show.html#2842" class="Bound">ξ</a> <a id="2844" class="Symbol">=</a> <a id="2846" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2849" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="2856" class="Symbol">(</a><a id="2857" href="SMT.Script.Base.html#6744" class="Function">Output</a> <a id="2864" href="SMT.Script.Show.html#2842" class="Bound">ξ</a><a id="2865" class="Symbol">)</a> <a id="2867" href="Relation.Unary.html#3359" class="Function">]</a>

  <a id="2872" class="Comment">-- |Mapping from output contexts to parser types.</a>
  <a id="2924" class="Comment">--</a>
  <a id="2929" class="Comment">-- TODO: Replace use of Env with All.</a>
  <a id="2969" class="Comment">--</a>
  <a id="2974" href="SMT.Script.Show.html#2974" class="Function">OutputParsers</a> <a id="2988" class="Symbol">:</a> <a id="2990" href="SMT.Script.Base.html#5617" class="Function">OutputCtxt</a> <a id="3001" class="Symbol">→</a> <a id="3003" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="3009" href="SMT.Script.Show.html#2974" class="Function">OutputParsers</a> <a id="3023" href="SMT.Script.Show.html#3023" class="Bound">Ξ</a> <a id="3025" class="Symbol">=</a> <a id="3027" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="3031" class="Symbol">(λ</a> <a id="3034" href="SMT.Script.Show.html#3034" class="Bound">ξ</a> <a id="3036" href="SMT.Script.Show.html#3036" class="Bound Operator">_Ξ</a> <a id="3039" class="Symbol">→</a> <a id="3041" href="SMT.Script.Show.html#2795" class="Function">OutputParser</a> <a id="3054" href="SMT.Script.Show.html#3034" class="Bound">ξ</a><a id="3055" class="Symbol">)</a> <a id="3057" href="SMT.Script.Show.html#3023" class="Bound">Ξ</a>

  <a id="3062" class="Comment">-- |Parse a satisfiability result.</a>
  <a id="3099" href="SMT.Script.Show.html#3099" class="Function">pSat</a> <a id="3104" class="Symbol">:</a> <a id="3106" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3109" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="3116" href="SMT.Script.Base.html#5768" class="Datatype">Sat</a> <a id="3120" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="3124" href="SMT.Script.Show.html#3099" class="Function">pSat</a> <a id="3129" class="Symbol">=</a> <a id="3131" href="SMT.Script.Base.html#5786" class="InductiveConstructor">sat</a>    <a id="3138" href="Text.Parser.html#4502" class="Function Operator">&lt;$</a> <a id="3141" href="Text.Parser.String.html#496" class="Function">lexeme</a> <a id="3148" class="String">&quot;sat&quot;</a>
    <a id="3158" href="Text.Parser.html#3943" class="Function Operator">&lt;|&gt;</a> <a id="3162" href="SMT.Script.Base.html#5802" class="InductiveConstructor">unsat</a>   <a id="3170" href="Text.Parser.html#4502" class="Function Operator">&lt;$</a> <a id="3173" href="Text.Parser.String.html#496" class="Function">lexeme</a> <a id="3180" class="String">&quot;unsat&quot;</a>
    <a id="3192" href="Text.Parser.html#3943" class="Function Operator">&lt;|&gt;</a> <a id="3196" href="SMT.Script.Base.html#5818" class="InductiveConstructor">unknown</a> <a id="3204" href="Text.Parser.html#4502" class="Function Operator">&lt;$</a> <a id="3207" href="Text.Parser.String.html#496" class="Function">lexeme</a> <a id="3214" class="String">&quot;unknown&quot;</a>

  <a id="3227" href="SMT.Script.Show.html#3227" class="Function">_</a> <a id="3229" class="Symbol">:</a> <a id="3231" href="SMT.Script.Show.html#3099" class="Function">pSat</a> <a id="3236" href="Text.Parser.String.html#1180" class="Function Operator">parses</a> <a id="3243" class="String">&quot;sat&quot;</a>
  <a id="3251" class="Symbol">_</a> <a id="3253" class="Symbol">=</a> <a id="3255" href="Data.Singleton.html#386" class="InductiveConstructor Operator">!</a> <a id="3257" href="SMT.Script.Base.html#5786" class="InductiveConstructor">sat</a>

  <a id="3264" href="SMT.Script.Show.html#3264" class="Function">_</a> <a id="3266" class="Symbol">:</a> <a id="3268" href="SMT.Script.Show.html#3099" class="Function">pSat</a> <a id="3273" href="Text.Parser.String.html#1180" class="Function Operator">parses</a> <a id="3280" class="String">&quot;unsat&quot;</a>
  <a id="3290" class="Symbol">_</a> <a id="3292" class="Symbol">=</a> <a id="3294" href="Data.Singleton.html#386" class="InductiveConstructor Operator">!</a> <a id="3296" href="SMT.Script.Base.html#5802" class="InductiveConstructor">unsat</a>

  <a id="3305" href="SMT.Script.Show.html#3305" class="Function">_</a> <a id="3307" class="Symbol">:</a> <a id="3309" href="SMT.Script.Show.html#3099" class="Function">pSat</a> <a id="3314" href="Text.Parser.String.html#1180" class="Function Operator">parses</a> <a id="3321" class="String">&quot;unknown&quot;</a>
  <a id="3333" class="Symbol">_</a> <a id="3335" class="Symbol">=</a> <a id="3337" href="Data.Singleton.html#386" class="InductiveConstructor Operator">!</a> <a id="3339" href="SMT.Script.Base.html#5818" class="InductiveConstructor">unknown</a>

  <a id="3350" href="SMT.Script.Show.html#3350" class="Function">_</a> <a id="3352" class="Symbol">:</a> <a id="3354" href="SMT.Script.Show.html#3099" class="Function">pSat</a> <a id="3359" href="Text.Parser.String.html#1615" class="Function Operator">rejects</a> <a id="3367" class="String">&quot;dogfood&quot;</a>
  <a id="3379" class="Symbol">_</a> <a id="3381" class="Symbol">=</a> <a id="3383" class="Symbol">_</a>


  <a id="3389" class="Comment">-- |Construct a definitions parser from a variable parser.</a>
  <a id="3450" class="Comment">--</a>
  <a id="3455" class="Comment">-- @</a>
  <a id="3462" class="Comment">--   (define-fun x0 () Int (- 1))</a>
  <a id="3498" class="Comment">-- @</a>
  <a id="3505" class="Comment">--</a>
  <a id="3510" href="SMT.Script.Show.html#3510" class="Function">mkDefnParser</a> <a id="3523" class="Symbol">:</a> <a id="3525" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3528" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="3535" class="Symbol">(</a><a id="3536" href="SMT.Script.Base.html#10035" class="Function">Var</a> <a id="3540" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a><a id="3541" class="Symbol">)</a> <a id="3543" href="Relation.Unary.html#3359" class="Function">]</a> <a id="3545" class="Symbol">→</a> <a id="3547" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3550" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="3557" class="Symbol">(</a><a id="3558" href="SMT.Script.Base.html#10110" class="Function">Defn</a> <a id="3563" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a><a id="3564" class="Symbol">)</a> <a id="3566" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="3570" href="SMT.Script.Show.html#3510" class="Function">mkDefnParser</a> <a id="3583" class="Symbol">{</a><a id="3584" href="SMT.Script.Show.html#3584" class="Bound">Γ</a><a id="3585" class="Symbol">}</a> <a id="3587" href="SMT.Script.Show.html#3587" class="Bound">pVar</a> <a id="3592" class="Symbol">=</a> <a id="3594" href="Text.Parser.html#8281" class="Function">withSpaces</a> <a id="3605" class="Symbol">(</a><a id="3606" href="Text.Parser.html#3575" class="Function">guardM</a> <a id="3613" href="SMT.Script.Show.html#3852" class="Function">checkDefn</a> <a id="3623" href="SMT.Script.Show.html#3648" class="Function">pVarVal</a><a id="3630" class="Symbol">)</a>
    <a id="3636" class="Keyword">where</a>
      <a id="3648" href="SMT.Script.Show.html#3648" class="Function">pVarVal</a> <a id="3656" class="Symbol">:</a> <a id="3658" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3661" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="3668" class="Symbol">(</a><a id="3669" href="SMT.Script.Base.html#10035" class="Function">Var</a> <a id="3673" href="SMT.Script.Show.html#3584" class="Bound">Γ</a> <a id="3675" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3677" href="SMT.Script.Base.html#10076" class="Function">Val</a><a id="3680" class="Symbol">)</a> <a id="3682" href="Relation.Unary.html#3359" class="Function">]</a>
      <a id="3690" href="SMT.Script.Show.html#3648" class="Function">pVarVal</a> <a id="3698" class="Symbol">=</a>
        <a id="3708" href="Text.Parser.html#8162" class="Function">parens</a> <a id="3715" class="Symbol">(</a><a id="3716" href="Text.Parser.html#3826" class="Function">box</a> <a id="3720" class="Symbol">(</a><a id="3721" href="Text.Parser.String.html#496" class="Function">lexeme</a> <a id="3728" class="String">&quot;define-fun&quot;</a> <a id="3741" href="Text.Parser.html#5153" class="Function Operator">&amp;&gt;</a> <a id="3744" href="Text.Parser.html#3826" class="Function">box</a> <a id="3748" class="Symbol">(</a><a id="3749" href="SMT.Script.Show.html#3587" class="Bound">pVar</a> <a id="3754" href="Text.Parser.html#5004" class="Function Operator">&lt;&amp;&gt;</a>
          <a id="3768" href="Text.Parser.html#3826" class="Function">box</a> <a id="3772" class="Symbol">(</a><a id="3773" href="Text.Parser.String.html#496" class="Function">lexeme</a> <a id="3780" class="String">&quot;()&quot;</a> <a id="3785" href="Text.Parser.html#5153" class="Function Operator">&amp;&gt;</a> <a id="3788" href="Text.Parser.html#3826" class="Function">box</a> <a id="3792" class="Symbol">(</a><a id="3793" href="SMT.Theory.Class.Parsable.html#525" class="Field">parseSort</a> <a id="3803" href="Text.Parser.html#4894" class="Function Operator">&gt;&gt;=</a> <a id="3807" class="Symbol">λ</a> <a id="3809" href="SMT.Script.Show.html#3809" class="Bound">σ</a> <a id="3811" class="Symbol">→</a> <a id="3813" href="Text.Parser.html#3826" class="Function">box</a> <a id="3817" class="Symbol">(</a><a id="3818" href="Data.Product.html#2247" class="Function Operator">-,_</a> <a id="3822" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="3826" href="SMT.Theory.Class.Parsable.html#559" class="Field">parseValue</a> <a id="3837" href="SMT.Script.Show.html#3809" class="Bound">σ</a><a id="3838" class="Symbol">))))))</a>

      <a id="3852" href="SMT.Script.Show.html#3852" class="Function">checkDefn</a> <a id="3862" class="Symbol">:</a> <a id="3864" href="SMT.Script.Base.html#10035" class="Function">Var</a> <a id="3868" href="SMT.Script.Show.html#3584" class="Bound">Γ</a> <a id="3870" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3872" href="SMT.Script.Base.html#10076" class="Function">Val</a> <a id="3876" class="Symbol">→</a> <a id="3878" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3884" class="Symbol">(</a><a id="3885" href="SMT.Script.Base.html#10110" class="Function">Defn</a> <a id="3890" href="SMT.Script.Show.html#3584" class="Bound">Γ</a><a id="3891" class="Symbol">)</a>
      <a id="3899" href="SMT.Script.Show.html#3852" class="Function">checkDefn</a> <a id="3909" class="Symbol">((</a><a id="3911" href="SMT.Script.Show.html#3911" class="Bound">σ</a> <a id="3913" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3915" href="SMT.Script.Show.html#3915" class="Bound">i</a><a id="3916" class="Symbol">)</a> <a id="3918" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3920" class="Symbol">(</a><a id="3921" href="SMT.Script.Show.html#3921" class="Bound">σ′</a> <a id="3924" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3926" href="SMT.Script.Show.html#3926" class="Bound">v</a><a id="3927" class="Symbol">))</a> <a id="3930" class="Keyword">with</a> <a id="3935" href="SMT.Script.Show.html#3911" class="Bound">σ</a> <a id="3937" href="SMT.Theory.Base.html#1786" class="Function Operator">≟-Sort</a> <a id="3944" href="SMT.Script.Show.html#3921" class="Bound">σ′</a>
      <a id="3953" class="Symbol">...</a> <a id="3957" class="Symbol">|</a> <a id="3959" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3963" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="3968" class="Symbol">=</a> <a id="3970" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3975" class="Symbol">(</a><a id="3976" class="Bound">σ</a> <a id="3978" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3980" class="Bound">i</a> <a id="3982" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3984" class="Bound">v</a><a id="3985" class="Symbol">)</a>
      <a id="3993" class="Symbol">...</a> <a id="3997" class="Symbol">|</a> <a id="3999" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="4003" class="Symbol">_</a>    <a id="4008" class="Symbol">=</a> <a id="4010" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>


  <a id="4022" class="Comment">-- |Construct a definition-list parser from a variable parser.</a>
  <a id="4087" class="Comment">--</a>
  <a id="4092" class="Comment">-- NOTE: The SMT-LIB standard specifies models as a series of definition.</a>
  <a id="4168" class="Comment">--       However, some versions of Z3 and CVC4 print them using &#39;model&#39;,</a>
  <a id="4243" class="Comment">--       e.g., `(model (define-fun x () Int 1))`, so Schmitty optionally</a>
  <a id="4318" class="Comment">--       allows the symbol &#39;model&#39; in the response.</a>
  <a id="4372" class="Comment">--</a>
  <a id="4377" href="SMT.Script.Show.html#4377" class="Function">mkDefnsParser</a> <a id="4391" class="Symbol">:</a> <a id="4393" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4396" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="4403" class="Symbol">(</a><a id="4404" href="SMT.Script.Base.html#10035" class="Function">Var</a> <a id="4408" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a><a id="4409" class="Symbol">)</a> <a id="4411" href="Relation.Unary.html#3359" class="Function">]</a> <a id="4413" class="Symbol">→</a> <a id="4415" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4418" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="4425" class="Symbol">(</a><a id="4426" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a> <a id="4432" class="Symbol">(</a><a id="4433" href="SMT.Script.Base.html#10110" class="Function">Defn</a> <a id="4438" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a><a id="4439" class="Symbol">))</a> <a id="4442" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="4446" href="SMT.Script.Show.html#4377" class="Function">mkDefnsParser</a> <a id="4460" class="Symbol">{</a><a id="4461" href="SMT.Script.Show.html#4461" class="Bound">Γ</a><a id="4462" class="Symbol">}</a> <a id="4464" href="SMT.Script.Show.html#4464" class="Bound">pVar</a> <a id="4469" class="Symbol">=</a>
    <a id="4475" href="Text.Parser.html#8281" class="Function">withSpaces</a> <a id="4486" class="Symbol">(</a><a id="4487" href="Text.Parser.html#8162" class="Function">parens</a> <a id="4494" class="Symbol">(</a><a id="4495" href="Text.Parser.html#3826" class="Function">box</a> <a id="4499" class="Symbol">(</a><a id="4500" href="Text.Parser.String.html#496" class="Function">lexeme</a> <a id="4507" class="String">&quot;model&quot;</a> <a id="4515" href="Text.Parser.html#6011" class="Function Operator">?&amp;&gt;</a> <a id="4519" href="Text.Parser.html#7094" class="Function">list⁺</a> <a id="4525" class="Symbol">(</a><a id="4526" href="SMT.Script.Show.html#3510" class="Function">mkDefnParser</a> <a id="4539" class="Symbol">{</a><a id="4540" href="SMT.Script.Show.html#4461" class="Bound">Γ</a><a id="4541" class="Symbol">}</a> <a id="4543" href="SMT.Script.Show.html#4464" class="Bound">pVar</a><a id="4547" class="Symbol">))))</a>


  <a id="4556" class="Keyword">private</a>
    <a id="4568" href="SMT.Script.Show.html#4568" class="Function">MaybeModel</a> <a id="4579" class="Symbol">:</a> <a id="4581" href="SMT.Script.Base.html#2388" class="Function">Ctxt</a> <a id="4586" class="Symbol">→</a> <a id="4588" href="Agda.Primitive.html#326" class="Primitive">Set</a>
    <a id="4596" href="SMT.Script.Show.html#4568" class="Function">MaybeModel</a> <a id="4607" href="SMT.Script.Show.html#4607" class="Bound">Γ</a> <a id="4609" class="Symbol">=</a> <a id="4611" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="4615" class="Symbol">(λ</a> <a id="4618" href="SMT.Script.Show.html#4618" class="Bound">σ</a> <a id="4620" href="SMT.Script.Show.html#4620" class="Bound Operator">_Γ</a> <a id="4623" class="Symbol">→</a> <a id="4625" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4630" class="Symbol">(</a><a id="4631" href="SMT.Theory.Base.html#2506" class="Function">Value</a> <a id="4637" href="SMT.Script.Show.html#4618" class="Bound">σ</a><a id="4638" class="Symbol">))</a> <a id="4641" href="SMT.Script.Show.html#4607" class="Bound">Γ</a>

    <a id="4648" href="SMT.Script.Show.html#4648" class="Function">insertMM</a> <a id="4657" class="Symbol">:</a> <a id="4659" href="Data.Product.html#1806" class="Function">∃[</a> <a id="4662" href="SMT.Script.Show.html#4662" class="Bound">σ</a> <a id="4664" href="Data.Product.html#1806" class="Function">]</a> <a id="4666" class="Symbol">(</a><a id="4667" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="4669" href="SMT.Script.Base.html#2611" class="Function Operator">∋</a> <a id="4671" href="SMT.Script.Show.html#4662" class="Bound">σ</a> <a id="4673" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4675" href="SMT.Theory.Base.html#2506" class="Function">Value</a> <a id="4681" href="SMT.Script.Show.html#4662" class="Bound">σ</a><a id="4682" class="Symbol">)</a> <a id="4684" class="Symbol">→</a> <a id="4686" href="SMT.Script.Show.html#4568" class="Function">MaybeModel</a> <a id="4697" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="4699" class="Symbol">→</a> <a id="4701" href="SMT.Script.Show.html#4568" class="Function">MaybeModel</a> <a id="4712" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a>
    <a id="4718" href="SMT.Script.Show.html#4648" class="Function">insertMM</a> <a id="4727" class="Symbol">{</a><a id="4728" class="DottedPattern Symbol">.</a><a id="4729" href="SMT.Script.Show.html#4737" class="DottedPattern Bound">σ</a> <a id="4731" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4733" href="SMT.Script.Show.html#4733" class="Bound">Γ</a><a id="4734" class="Symbol">}</a> <a id="4736" class="Symbol">(</a><a id="4737" href="SMT.Script.Show.html#4737" class="Bound">σ</a> <a id="4739" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4741" class="Symbol">(</a><a id="4742" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="4747" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="4751" class="Symbol">)</a> <a id="4753" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4755" href="SMT.Script.Show.html#4755" class="Bound">v</a><a id="4756" class="Symbol">)</a> <a id="4758" class="Symbol">(</a><a id="4759" href="SMT.Script.Show.html#4759" class="Bound">vs</a> <a id="4762" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4764" href="SMT.Script.Show.html#4764" class="Bound">env</a><a id="4767" class="Symbol">)</a> <a id="4769" class="Symbol">=</a> <a id="4771" class="Symbol">(</a><a id="4772" href="SMT.Script.Show.html#4755" class="Bound">v</a> <a id="4774" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4776" href="SMT.Script.Show.html#4759" class="Bound">vs</a><a id="4778" class="Symbol">)</a> <a id="4780" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4782" href="SMT.Script.Show.html#4764" class="Bound">env</a>
    <a id="4790" href="SMT.Script.Show.html#4648" class="Function">insertMM</a> <a id="4799" class="Symbol">{</a><a id="4800" href="SMT.Script.Show.html#4800" class="Bound">σ′</a> <a id="4803" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4805" href="SMT.Script.Show.html#4805" class="Bound">Γ</a><a id="4806" class="Symbol">}</a> <a id="4808" class="Symbol">(</a><a id="4809" href="SMT.Script.Show.html#4809" class="Bound">σ</a> <a id="4811" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4813" class="Symbol">(</a><a id="4814" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="4820" href="SMT.Script.Show.html#4820" class="Bound">p</a><a id="4821" class="Symbol">)</a>   <a id="4825" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4827" href="SMT.Script.Show.html#4827" class="Bound">v</a><a id="4828" class="Symbol">)</a> <a id="4830" class="Symbol">(</a><a id="4831" href="SMT.Script.Show.html#4831" class="Bound">vs</a> <a id="4834" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4836" href="SMT.Script.Show.html#4836" class="Bound">env</a><a id="4839" class="Symbol">)</a> <a id="4841" class="Symbol">=</a> <a id="4843" href="SMT.Script.Show.html#4831" class="Bound">vs</a> <a id="4846" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4848" href="SMT.Script.Show.html#4648" class="Function">insertMM</a> <a id="4857" class="Symbol">(</a><a id="4858" href="SMT.Script.Show.html#4809" class="Bound">σ</a> <a id="4860" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4862" href="SMT.Script.Show.html#4820" class="Bound">p</a> <a id="4864" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4866" href="SMT.Script.Show.html#4827" class="Bound">v</a><a id="4867" class="Symbol">)</a> <a id="4869" href="SMT.Script.Show.html#4836" class="Bound">env</a>

    <a id="4878" href="SMT.Script.Show.html#4878" class="Function">mkMM</a> <a id="4883" class="Symbol">:</a> <a id="4885" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4890" class="Symbol">(</a><a id="4891" href="SMT.Script.Base.html#10110" class="Function">Defn</a> <a id="4896" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a><a id="4897" class="Symbol">)</a> <a id="4899" class="Symbol">→</a> <a id="4901" href="SMT.Script.Show.html#4568" class="Function">MaybeModel</a> <a id="4912" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a>
    <a id="4918" href="SMT.Script.Show.html#4878" class="Function">mkMM</a> <a id="4923" class="Symbol">{</a><a id="4924" href="SMT.Script.Show.html#4924" class="Bound">Γ</a><a id="4925" class="Symbol">}</a> <a id="4927" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="4936" class="Symbol">=</a> <a id="4938" href="Data.Environment.html#1028" class="Function">Env.repeat</a> <a id="4949" class="Symbol">(λ</a> <a id="4952" href="SMT.Script.Show.html#4952" class="Bound Operator">_σ</a> <a id="4955" href="SMT.Script.Show.html#4955" class="Bound Operator">_Γ</a> <a id="4958" class="Symbol">→</a> <a id="4960" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4962" class="Symbol">)</a> <a id="4964" href="SMT.Script.Show.html#4924" class="Bound">Γ</a>
    <a id="4970" href="SMT.Script.Show.html#4878" class="Function">mkMM</a> <a id="4975" class="Symbol">{</a><a id="4976" href="SMT.Script.Show.html#4976" class="Bound">Γ</a><a id="4977" class="Symbol">}</a> <a id="4979" class="Symbol">(</a><a id="4980" href="SMT.Script.Show.html#4980" class="Bound">v</a> <a id="4982" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4984" href="SMT.Script.Show.html#4984" class="Bound">vs</a><a id="4986" class="Symbol">)</a> <a id="4988" class="Symbol">=</a> <a id="4990" href="SMT.Script.Show.html#4648" class="Function">insertMM</a> <a id="4999" href="SMT.Script.Show.html#4980" class="Bound">v</a> <a id="5001" class="Symbol">(</a><a id="5002" href="SMT.Script.Show.html#4878" class="Function">mkMM</a> <a id="5007" href="SMT.Script.Show.html#4984" class="Bound">vs</a><a id="5009" class="Symbol">)</a>

    <a id="5016" href="SMT.Script.Show.html#5016" class="Function">fromSingleton</a> <a id="5030" class="Symbol">:</a> <a id="5032" class="Symbol">{</a><a id="5033" href="SMT.Script.Show.html#5033" class="Bound">A</a> <a id="5035" class="Symbol">:</a> <a id="5037" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="5040" class="Symbol">}</a> <a id="5042" class="Symbol">→</a> <a id="5044" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5049" href="SMT.Script.Show.html#5033" class="Bound">A</a> <a id="5051" class="Symbol">→</a> <a id="5053" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5059" href="SMT.Script.Show.html#5033" class="Bound">A</a>
    <a id="5065" href="SMT.Script.Show.html#5016" class="Function">fromSingleton</a> <a id="5079" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="5082" class="Symbol">=</a> <a id="5084" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
    <a id="5096" href="SMT.Script.Show.html#5016" class="Function">fromSingleton</a> <a id="5110" class="Symbol">(</a><a id="5111" href="SMT.Script.Show.html#5111" class="Bound">v</a> <a id="5113" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5115" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="5117" class="Symbol">)</a> <a id="5119" class="Symbol">=</a> <a id="5121" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5126" href="SMT.Script.Show.html#5111" class="Bound">v</a>
    <a id="5132" href="SMT.Script.Show.html#5016" class="Function">fromSingleton</a> <a id="5146" class="Symbol">(_</a> <a id="5149" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5151" class="Symbol">_</a> <a id="5153" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5155" class="Symbol">_)</a> <a id="5158" class="Symbol">=</a> <a id="5160" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

    <a id="5173" href="SMT.Script.Show.html#5173" class="Function">checkMM</a> <a id="5181" class="Symbol">:</a> <a id="5183" href="SMT.Script.Show.html#4568" class="Function">MaybeModel</a> <a id="5194" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="5196" class="Symbol">→</a> <a id="5198" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5204" class="Symbol">(</a><a id="5205" href="SMT.Script.Base.html#6459" class="Datatype">Model</a> <a id="5211" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a><a id="5212" class="Symbol">)</a>
    <a id="5218" href="SMT.Script.Show.html#5173" class="Function">checkMM</a> <a id="5226" href="Data.Environment.html#410" class="InductiveConstructor">[]</a> <a id="5229" class="Symbol">=</a> <a id="5231" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5236" href="SMT.Script.Base.html#6492" class="InductiveConstructor">[]</a>
    <a id="5243" href="SMT.Script.Show.html#5173" class="Function">checkMM</a> <a id="5251" class="Symbol">(</a><a id="5252" href="SMT.Script.Show.html#5252" class="Bound">vs</a> <a id="5255" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="5257" href="SMT.Script.Show.html#5257" class="Bound">env</a><a id="5260" class="Symbol">)</a> <a id="5262" class="Symbol">=</a> <a id="5264" href="Data.Maybe.Base.html#2868" class="Function">Maybe.zipWith</a> <a id="5278" href="SMT.Script.Base.html#6509" class="InductiveConstructor Operator">_∷_</a> <a id="5282" class="Symbol">(</a><a id="5283" href="SMT.Script.Show.html#5016" class="Function">fromSingleton</a> <a id="5297" href="SMT.Script.Show.html#5252" class="Bound">vs</a><a id="5299" class="Symbol">)</a> <a id="5301" class="Symbol">(</a><a id="5302" href="SMT.Script.Show.html#5173" class="Function">checkMM</a> <a id="5310" href="SMT.Script.Show.html#5257" class="Bound">env</a><a id="5313" class="Symbol">)</a>

  <a id="5318" href="SMT.Script.Show.html#5318" class="Function">pModelError</a> <a id="5330" class="Symbol">:</a> <a id="5332" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5335" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="5342" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a> <a id="5344" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="5348" href="SMT.Script.Show.html#5318" class="Function">pModelError</a> <a id="5360" class="Symbol">=</a> <a id="5362" class="Symbol">_</a> <a id="5364" href="Text.Parser.html#4502" class="Function Operator">&lt;$</a> <a id="5367" href="Text.Parser.html#8281" class="Function">withSpaces</a> <a id="5378" class="Symbol">(</a><a id="5379" href="Text.Parser.html#8162" class="Function">parens</a> <a id="5386" class="Symbol">(</a>
    <a id="5392" href="Text.Parser.html#3826" class="Function">box</a> <a id="5396" class="Symbol">(</a><a id="5397" href="Text.Parser.String.html#496" class="Function">lexeme</a> <a id="5404" class="String">&quot;error&quot;</a> <a id="5412" href="Text.Parser.html#5153" class="Function Operator">&amp;&gt;</a> <a id="5415" href="Text.Parser.html#3826" class="Function">box</a> <a id="5419" class="Symbol">(</a><a id="5420" href="Text.Parser.html#6082" class="Function">between</a> <a id="5428" class="Symbol">(</a><a id="5429" href="Text.Parser.html#7748" class="Function">char</a> <a id="5434" class="String">&#39;&quot;&#39;</a><a id="5437" class="Symbol">)</a> <a id="5439" class="Symbol">(</a><a id="5440" href="Text.Parser.html#3826" class="Function">box</a> <a id="5444" class="Symbol">(</a><a id="5445" href="Text.Parser.html#7748" class="Function">char</a> <a id="5450" class="String">&#39;&quot;&#39;</a><a id="5453" class="Symbol">))</a> <a id="5456" class="Symbol">(</a><a id="5457" href="Text.Parser.html#3826" class="Function">box</a> <a id="5461" class="Symbol">(</a><a id="5462" href="Text.Parser.html#7094" class="Function">list⁺</a> <a id="5468" class="Symbol">(</a><a id="5469" href="Text.Parser.html#6610" class="Function">anyCharBut</a> <a id="5480" class="String">&#39;&quot;&#39;</a><a id="5483" class="Symbol">)))))))</a>

  <a id="5494" class="Comment">-- |Construct a model parser from a variable parser.</a>
  <a id="5549" href="SMT.Script.Show.html#5549" class="Function">mkModelParser</a> <a id="5563" class="Symbol">:</a> <a id="5565" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5568" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="5575" class="Symbol">(</a><a id="5576" href="SMT.Script.Base.html#10035" class="Function">Var</a> <a id="5580" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a><a id="5581" class="Symbol">)</a> <a id="5583" href="Relation.Unary.html#3359" class="Function">]</a> <a id="5585" class="Symbol">→</a> <a id="5587" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5590" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="5597" class="Symbol">(</a><a id="5598" href="SMT.Script.Base.html#6550" class="Function">QualifiedModel</a> <a id="5613" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a><a id="5614" class="Symbol">)</a> <a id="5616" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="5620" href="SMT.Script.Show.html#5549" class="Function">mkModelParser</a> <a id="5634" class="Symbol">{</a><a id="5635" href="SMT.Script.Show.html#5635" class="Bound">Γ</a><a id="5636" class="Symbol">}</a> <a id="5638" href="SMT.Script.Show.html#5638" class="Bound">pVar</a> <a id="5643" class="Symbol">=</a> <a id="5645" class="Keyword">do</a>
    <a id="5652" href="SMT.Script.Show.html#5652" class="Bound">s</a> <a id="5654" href="Text.Parser.html#4894" class="Function Operator">←</a> <a id="5656" href="SMT.Script.Show.html#3099" class="Function">pSat</a>
    <a id="5665" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="5670" href="SMT.Script.Show.html#5652" class="Bound">s</a> <a id="5672" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="5675" class="Symbol">λ</a> <a id="5677" class="Keyword">where</a>
      <a id="5689" href="SMT.Script.Base.html#5786" class="InductiveConstructor">sat</a>     <a id="5697" class="Symbol">→</a> <a id="5699" href="Text.Parser.html#3826" class="Function">box</a> <a id="5703" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5705" class="Symbol">(</a><a id="5706" href="SMT.Script.Base.html#5786" class="InductiveConstructor">sat</a> <a id="5710" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="5712" class="Symbol">)</a>     <a id="5718" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="5722" href="SMT.Script.Show.html#5922" class="Function">pModel</a>
      <a id="5735" href="SMT.Script.Base.html#5802" class="InductiveConstructor">unsat</a>   <a id="5743" class="Symbol">→</a> <a id="5745" href="Text.Parser.html#3826" class="Function">box</a> <a id="5749" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5751" class="Symbol">(</a><a id="5752" href="SMT.Script.Base.html#5802" class="InductiveConstructor">unsat</a> <a id="5758" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="5760" class="Symbol">)</a>   <a id="5764" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="5768" href="SMT.Script.Show.html#5318" class="Function">pModelError</a>
      <a id="5786" href="SMT.Script.Base.html#5818" class="InductiveConstructor">unknown</a> <a id="5794" class="Symbol">→</a> <a id="5796" href="Text.Parser.html#3826" class="Function">box</a> <a id="5800" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5802" class="Symbol">(</a><a id="5803" href="SMT.Script.Base.html#5818" class="InductiveConstructor">unknown</a> <a id="5811" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="5813" class="Symbol">)</a> <a id="5815" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="5819" href="SMT.Script.Show.html#5318" class="Function">pModelError</a>
    <a id="5835" class="Keyword">where</a>
      <a id="5847" class="Comment">-- Insert each definition into a model, and check if it is complete.</a>
      <a id="5922" href="SMT.Script.Show.html#5922" class="Function">pModel</a> <a id="5929" class="Symbol">:</a> <a id="5931" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5934" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="5941" class="Symbol">(</a><a id="5942" href="SMT.Script.Base.html#6459" class="Datatype">Model</a> <a id="5948" href="SMT.Script.Show.html#5635" class="Bound">Γ</a><a id="5949" class="Symbol">)</a> <a id="5951" href="Relation.Unary.html#3359" class="Function">]</a>
      <a id="5959" href="SMT.Script.Show.html#5922" class="Function">pModel</a> <a id="5966" class="Symbol">=</a> <a id="5968" href="Text.Parser.html#3575" class="Function">guardM</a> <a id="5975" href="SMT.Script.Show.html#5173" class="Function">checkMM</a> <a id="5983" class="Symbol">(</a><a id="5984" href="SMT.Script.Show.html#4878" class="Function">mkMM</a> <a id="5989" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5991" href="Data.List.NonEmpty.Base.html#1521" class="Function">List⁺.toList</a> <a id="6004" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="6008" href="SMT.Script.Show.html#4377" class="Function">mkDefnsParser</a> <a id="6022" class="Symbol">{</a><a id="6023" href="SMT.Script.Show.html#5635" class="Bound">Γ</a><a id="6024" class="Symbol">}</a> <a id="6026" href="SMT.Script.Show.html#5638" class="Bound">pVar</a><a id="6030" class="Symbol">)</a>

      <a id="6039" href="SMT.Script.Show.html#6039" class="Function">pMaybeQualifiedModel</a> <a id="6060" class="Symbol">:</a> <a id="6062" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="6065" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="6072" class="Symbol">(</a><a id="6073" href="SMT.Script.Base.html#5768" class="Datatype">Sat</a> <a id="6077" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6079" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="6085" class="Symbol">(</a><a id="6086" href="SMT.Script.Base.html#6459" class="Datatype">Model</a> <a id="6092" href="SMT.Script.Show.html#5635" class="Bound">Γ</a><a id="6093" class="Symbol">))</a> <a id="6096" href="Relation.Unary.html#3359" class="Function">]</a>
      <a id="6104" href="SMT.Script.Show.html#6039" class="Function">pMaybeQualifiedModel</a> <a id="6125" class="Symbol">=</a> <a id="6127" href="SMT.Script.Show.html#3099" class="Function">pSat</a> <a id="6132" href="Text.Parser.html#5484" class="Function Operator">&lt;&amp;?&gt;</a> <a id="6137" href="Text.Parser.html#3826" class="Function">box</a> <a id="6141" href="SMT.Script.Show.html#5922" class="Function">pModel</a>

      <a id="6155" href="SMT.Script.Show.html#6155" class="Function">mkQualifiedModel</a> <a id="6172" class="Symbol">:</a> <a id="6174" href="SMT.Script.Base.html#5768" class="Datatype">Sat</a> <a id="6178" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6180" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="6186" class="Symbol">(</a><a id="6187" href="SMT.Script.Base.html#6459" class="Datatype">Model</a> <a id="6193" href="SMT.Script.Show.html#5635" class="Bound">Γ</a><a id="6194" class="Symbol">)</a> <a id="6196" class="Symbol">→</a> <a id="6198" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="6204" class="Symbol">(</a><a id="6205" href="SMT.Script.Base.html#6550" class="Function">QualifiedModel</a> <a id="6220" href="SMT.Script.Show.html#5635" class="Bound">Γ</a><a id="6221" class="Symbol">)</a>
      <a id="6229" href="SMT.Script.Show.html#6155" class="Function">mkQualifiedModel</a> <a id="6246" class="Symbol">(</a><a id="6247" href="SMT.Script.Base.html#5786" class="InductiveConstructor">sat</a>     <a id="6255" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6257" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6262" href="SMT.Script.Show.html#6262" class="Bound">m</a><a id="6263" class="Symbol">)</a>  <a id="6266" class="Symbol">=</a> <a id="6268" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6273" class="Symbol">(</a><a id="6274" href="SMT.Script.Base.html#5786" class="InductiveConstructor">sat</a>     <a id="6282" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6284" href="SMT.Script.Show.html#6262" class="Bound">m</a><a id="6285" class="Symbol">)</a>
      <a id="6293" href="SMT.Script.Show.html#6155" class="Function">mkQualifiedModel</a> <a id="6310" class="Symbol">(</a><a id="6311" href="SMT.Script.Base.html#5802" class="InductiveConstructor">unsat</a>   <a id="6319" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6321" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="6328" class="Symbol">)</a> <a id="6330" class="Symbol">=</a> <a id="6332" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6337" class="Symbol">(</a><a id="6338" href="SMT.Script.Base.html#5802" class="InductiveConstructor">unsat</a>   <a id="6346" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6348" class="Symbol">_)</a>
      <a id="6357" href="SMT.Script.Show.html#6155" class="Function">mkQualifiedModel</a> <a id="6374" class="Symbol">(</a><a id="6375" href="SMT.Script.Base.html#5818" class="InductiveConstructor">unknown</a> <a id="6383" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6385" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="6392" class="Symbol">)</a> <a id="6394" class="Symbol">=</a> <a id="6396" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6401" class="Symbol">(</a><a id="6402" href="SMT.Script.Base.html#5818" class="InductiveConstructor">unknown</a> <a id="6410" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6412" class="Symbol">_)</a>
      <a id="6421" href="SMT.Script.Show.html#6155" class="CatchallClause Function">mkQualifiedModel</a><a id="6437" class="CatchallClause"> </a><a id="6438" class="CatchallClause Symbol">(_</a><a id="6440" class="CatchallClause">       </a><a id="6447" href="Agda.Builtin.Sigma.html#236" class="CatchallClause InductiveConstructor Operator">,</a><a id="6448" class="CatchallClause"> </a><a id="6449" class="CatchallClause Symbol">_)</a>       <a id="6458" class="Symbol">=</a> <a id="6460" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>


  <a id="6472" href="SMT.Script.Show.html#6472" class="Function">mkOutputParsers⁺</a> <a id="6489" class="Symbol">:</a> <a id="6491" href="SMT.Script.Show.html#2974" class="Function">OutputParsers</a> <a id="6505" class="Symbol">(</a><a id="6506" href="SMT.Script.Show.html#2186" class="Generalizable">ξ</a> <a id="6508" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6510" href="SMT.Script.Show.html#2211" class="Generalizable">Ξ</a><a id="6511" class="Symbol">)</a> <a id="6513" class="Symbol">→</a> <a id="6515" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="6518" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="6525" class="Symbol">(</a><a id="6526" href="SMT.Script.Base.html#7142" class="Datatype">Outputs</a> <a id="6534" class="Symbol">(</a><a id="6535" href="SMT.Script.Show.html#2186" class="Generalizable">ξ</a> <a id="6537" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6539" href="SMT.Script.Show.html#2211" class="Generalizable">Ξ</a><a id="6540" class="Symbol">))</a> <a id="6543" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="6547" href="SMT.Script.Show.html#6472" class="Function">mkOutputParsers⁺</a> <a id="6564" class="Symbol">(</a><a id="6565" href="SMT.Script.Show.html#6565" class="Bound">op</a> <a id="6568" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6570" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="6572" class="Symbol">)</a>          <a id="6583" class="Symbol">=</a> <a id="6585" class="Symbol">(</a><a id="6586" href="SMT.Script.Base.html#7202" class="InductiveConstructor Operator">_∷</a> <a id="6589" href="SMT.Script.Base.html#7183" class="InductiveConstructor">[]</a><a id="6591" class="Symbol">)</a> <a id="6593" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="6597" href="SMT.Script.Show.html#6565" class="Bound">op</a>
  <a id="6602" href="SMT.Script.Show.html#6472" class="Function">mkOutputParsers⁺</a> <a id="6619" class="Symbol">(</a><a id="6620" href="SMT.Script.Show.html#6620" class="Bound">op</a> <a id="6623" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6625" href="SMT.Script.Show.html#6625" class="Bound">ops</a><a id="6628" class="Symbol">@(_</a> <a id="6632" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6634" class="Symbol">_))</a> <a id="6638" class="Symbol">=</a> <a id="6640" href="Function.Base.html#1554" class="Function">flip</a> <a id="6645" href="SMT.Script.Base.html#7202" class="InductiveConstructor Operator">_∷_</a> <a id="6649" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="6653" href="SMT.Script.Show.html#6472" class="Function">mkOutputParsers⁺</a> <a id="6670" href="SMT.Script.Show.html#6625" class="Bound">ops</a> <a id="6674" href="Text.Parser.html#5377" class="Function Operator">&lt;*&gt;</a> <a id="6678" href="Text.Parser.html#3826" class="Function">box</a> <a id="6682" href="SMT.Script.Show.html#6620" class="Bound">op</a>

  <a id="6688" href="SMT.Script.Show.html#6688" class="Function">mkOutputParsers</a> <a id="6704" class="Symbol">:</a> <a id="6706" href="SMT.Script.Show.html#2974" class="Function">OutputParsers</a> <a id="6720" href="SMT.Script.Show.html#2211" class="Generalizable">Ξ</a> <a id="6722" class="Symbol">→</a> <a id="6724" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="6731" class="Symbol">→</a> <a id="6733" href="Text.Parser.Position.html#380" class="Record">Position</a> <a id="6742" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="6744" href="SMT.Script.Base.html#7142" class="Datatype">Outputs</a> <a id="6752" href="SMT.Script.Show.html#2211" class="Generalizable">Ξ</a>
  <a id="6756" href="SMT.Script.Show.html#6688" class="Function">mkOutputParsers</a> <a id="6772" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>         <a id="6783" href="SMT.Script.Show.html#6783" class="Bound">s</a> <a id="6785" class="Symbol">=</a> <a id="6787" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="6792" href="Text.Parser.Position.html#479" class="Function">Position.start</a>
  <a id="6809" href="SMT.Script.Show.html#6688" class="Function">mkOutputParsers</a> <a id="6825" class="Symbol">(</a><a id="6826" href="SMT.Script.Show.html#6826" class="Bound">op</a> <a id="6829" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6831" href="SMT.Script.Show.html#6831" class="Bound">ops</a><a id="6834" class="Symbol">)</a> <a id="6836" href="SMT.Script.Show.html#6836" class="Bound">s</a> <a id="6838" class="Symbol">=</a> <a id="6840" href="Text.Parser.html#2812" class="Function">runParser</a> <a id="6850" class="Symbol">(</a><a id="6851" href="SMT.Script.Show.html#6472" class="Function">mkOutputParsers⁺</a> <a id="6868" class="Symbol">(</a><a id="6869" href="SMT.Script.Show.html#6826" class="Bound">op</a> <a id="6872" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6874" href="SMT.Script.Show.html#6831" class="Bound">ops</a><a id="6877" class="Symbol">))</a> <a id="6880" href="SMT.Script.Show.html#6836" class="Bound">s</a>


<a id="6884" class="Comment">-- * Pretty printer</a>

<a id="6905" class="Keyword">module</a> <a id="6912" href="SMT.Script.Show.html#6912" class="Module">_</a> <a id="6914" class="Keyword">where</a>

  <a id="6923" class="Keyword">open</a> <a id="6928" class="Keyword">import</a> <a id="6935" href="Category.Monad.State.html" class="Module">Category.Monad.State</a> <a id="6956" class="Symbol">as</a> <a id="6959" class="Module">StateCat</a> <a id="6968" class="Keyword">using</a> <a id="6974" class="Symbol">(</a><a id="6975" href="Category.Monad.State.html#2659" class="Record">RawIMonadState</a><a id="6989" class="Symbol">;</a> <a id="6991" href="Category.Monad.State.html#666" class="Function">IStateT</a><a id="6998" class="Symbol">)</a>
  <a id="7002" class="Keyword">open</a> <a id="7007" class="Keyword">import</a> <a id="7014" href="Text.Parser.String.html" class="Module">Text.Parser.String</a> <a id="7033" class="Keyword">using</a> <a id="7039" class="Symbol">(</a><a id="7040" href="Relation.Unary.html#3359" class="Function">IUniversal</a><a id="7050" class="Symbol">;</a> <a id="7052" href="Text.Parser.html#2710" class="Function">Parser</a><a id="7058" class="Symbol">;</a> <a id="7060" href="Text.Parser.html#4502" class="Function Operator">_&lt;$_</a><a id="7064" class="Symbol">;</a> <a id="7066" href="Text.Parser.html#8281" class="Function">withSpaces</a><a id="7076" class="Symbol">;</a> <a id="7078" href="Text.Parser.html#6390" class="Function">exacts</a><a id="7084" class="Symbol">)</a>

  <a id="7089" href="SMT.Script.Show.html#7089" class="Function">NameState</a> <a id="7099" class="Symbol">:</a> <a id="7101" class="Symbol">(</a><a id="7102" href="SMT.Script.Show.html#7102" class="Bound">Γ</a> <a id="7104" href="SMT.Script.Show.html#7104" class="Bound">Γ′</a> <a id="7107" class="Symbol">:</a> <a id="7109" href="SMT.Script.Base.html#2388" class="Function">Ctxt</a><a id="7113" class="Symbol">)</a> <a id="7115" class="Symbol">→</a> <a id="7117" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="7121" class="Symbol">→</a> <a id="7123" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="7129" href="SMT.Script.Show.html#7089" class="Function">NameState</a> <a id="7139" href="SMT.Script.Show.html#7139" class="Bound">Γ</a> <a id="7141" href="SMT.Script.Show.html#7141" class="Bound">Γ′</a> <a id="7144" href="SMT.Script.Show.html#7144" class="Bound">A</a> <a id="7146" class="Symbol">=</a> <a id="7148" href="Category.Monad.State.html#666" class="Function">IStateT</a> <a id="7156" class="Symbol">(λ</a> <a id="7159" href="SMT.Script.Show.html#7159" class="Bound">Γ</a> <a id="7161" class="Symbol">→</a> <a id="7163" href="SMT.Script.Names.html#2365" class="Record">Names</a> <a id="7169" href="SMT.Script.Show.html#7159" class="Bound">Γ</a> <a id="7171" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7173" href="SMT.Script.Show.html#2364" class="Function">VarParsers</a> <a id="7184" href="SMT.Script.Show.html#7159" class="Bound">Γ</a><a id="7185" class="Symbol">)</a> <a id="7187" href="Function.Base.html#615" class="Function">id</a> <a id="7190" href="SMT.Script.Show.html#7139" class="Bound">Γ</a> <a id="7192" href="SMT.Script.Show.html#7141" class="Bound">Γ′</a> <a id="7195" href="SMT.Script.Show.html#7144" class="Bound">A</a>

  <a id="7200" class="Comment">-- When showing terms, we need to pass around a name state,</a>
  <a id="7262" class="Comment">-- for which we&#39;ll use an indexed monad, indexed by the context,</a>
  <a id="7329" class="Comment">-- so we bring the functions from the indexed monad in scope.</a>
  <a id="7393" class="Keyword">private</a>
    <a id="7405" href="SMT.Script.Show.html#7405" class="Function">monadStateNameState</a> <a id="7425" class="Symbol">=</a>
      <a id="7433" href="Category.Monad.State.html#2986" class="Function">StateCat.StateTIMonadState</a> <a id="7460" class="Symbol">(λ</a> <a id="7463" href="SMT.Script.Show.html#7463" class="Bound">Γ</a> <a id="7465" class="Symbol">→</a> <a id="7467" href="SMT.Script.Names.html#2365" class="Record">Names</a> <a id="7473" href="SMT.Script.Show.html#7463" class="Bound">Γ</a> <a id="7475" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7477" href="SMT.Script.Show.html#2364" class="Function">VarParsers</a> <a id="7488" href="SMT.Script.Show.html#7463" class="Bound">Γ</a><a id="7489" class="Symbol">)</a> <a id="7491" href="Function.Identity.Categorical.html#651" class="Function">Identity.monad</a>

  <a id="7509" class="Keyword">open</a> <a id="7514" href="Category.Monad.State.html#2659" class="Module">RawIMonadState</a> <a id="7529" href="SMT.Script.Show.html#7405" class="Function">monadStateNameState</a>
    <a id="7553" class="Keyword">using</a> <a id="7559" class="Symbol">(</a><a id="7560" href="Category.Monad.Indexed.html#644" class="Function">return</a><a id="7566" class="Symbol">;</a> <a id="7568" href="Category.Monad.Indexed.html#677" class="Function Operator">_&gt;&gt;=_</a><a id="7573" class="Symbol">;</a> <a id="7575" href="Category.Monad.Indexed.html#735" class="Function Operator">_&gt;&gt;_</a><a id="7579" class="Symbol">;</a> <a id="7581" href="Category.Monad.State.html#2831" class="Field">put</a><a id="7584" class="Symbol">;</a> <a id="7586" href="Category.Monad.State.html#2799" class="Field">get</a><a id="7589" class="Symbol">;</a> <a id="7591" href="Category.Monad.State.html#2906" class="Function">modify</a><a id="7597" class="Symbol">)</a>

  <a id="7602" href="SMT.Script.Show.html#7602" class="Function">freshNameS</a> <a id="7613" class="Symbol">:</a> <a id="7615" class="Symbol">(</a><a id="7616" href="SMT.Script.Show.html#7616" class="Bound">n</a> <a id="7618" class="Symbol">:</a> <a id="7620" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="7626" class="Symbol">)</a> <a id="7628" class="Symbol">(</a><a id="7629" href="SMT.Script.Show.html#7629" class="Bound">σ</a> <a id="7631" class="Symbol">:</a> <a id="7633" href="SMT.Theory.Base.html#1762" class="Function">Sort</a><a id="7637" class="Symbol">)</a> <a id="7639" class="Symbol">→</a> <a id="7641" href="SMT.Script.Show.html#7089" class="Function">NameState</a> <a id="7651" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="7653" class="Symbol">(</a><a id="7654" href="SMT.Script.Show.html#7629" class="Bound">σ</a> <a id="7656" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7658" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a><a id="7659" class="Symbol">)</a> <a id="7661" href="SMT.Script.Names.html#1779" class="Function">Name</a>
  <a id="7668" href="SMT.Script.Show.html#7602" class="Function">freshNameS</a> <a id="7679" href="SMT.Script.Show.html#7679" class="Bound">n</a> <a id="7681" href="SMT.Script.Show.html#7681" class="Bound">σ</a> <a id="7683" class="Symbol">=</a> <a id="7685" class="Keyword">do</a>
    <a id="7692" class="Symbol">(</a><a id="7693" href="SMT.Script.Show.html#7693" class="Bound">ns</a> <a id="7696" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7698" href="SMT.Script.Show.html#7698" class="Bound">vps</a><a id="7701" class="Symbol">)</a> <a id="7703" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7705" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="7713" class="Keyword">let</a> <a id="7717" class="Symbol">(</a><a id="7718" href="SMT.Script.Show.html#7718" class="Bound">n′</a> <a id="7721" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7723" href="SMT.Script.Show.html#7723" class="Bound">ns</a><a id="7725" class="Symbol">)</a> <a id="7727" class="Symbol">=</a> <a id="7729" href="SMT.Script.Names.html#2575" class="Function">freshName</a> <a id="7739" href="SMT.Script.Show.html#7679" class="Bound">n</a> <a id="7741" href="SMT.Script.Show.html#7681" class="Bound">σ</a> <a id="7743" href="SMT.Script.Show.html#7693" class="Bound">ns</a>
    <a id="7750" class="Keyword">let</a> <a id="7754" href="SMT.Script.Show.html#7754" class="Bound">vps</a> <a id="7758" class="Symbol">=</a> <a id="7760" class="Symbol">(</a><a id="7761" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="7766" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="7771" href="Text.Parser.html#4502" class="Function Operator">&lt;$</a> <a id="7774" href="Text.Parser.html#8281" class="Function">withSpaces</a> <a id="7785" class="Symbol">(</a><a id="7786" href="Text.Parser.html#6390" class="Function">exacts</a> <a id="7793" href="SMT.Script.Show.html#7718" class="Bound">n′</a><a id="7795" class="Symbol">))</a> <a id="7798" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="7800" href="SMT.Script.Show.html#7698" class="Bound">vps</a>
    <a id="7808" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="7812" class="Symbol">(</a><a id="7813" href="SMT.Script.Show.html#7723" class="Bound">ns</a> <a id="7816" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7818" href="SMT.Script.Show.html#7754" class="Bound">vps</a><a id="7821" class="Symbol">)</a>
    <a id="7827" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7834" href="SMT.Script.Show.html#7718" class="Bound">n′</a>

  <a id="7840" href="SMT.Script.Show.html#7840" class="Function">dropNameS</a> <a id="7850" class="Symbol">:</a> <a id="7852" href="SMT.Script.Show.html#7089" class="Function">NameState</a> <a id="7862" class="Symbol">(</a><a id="7863" href="SMT.Script.Show.html#2076" class="Generalizable">σ</a> <a id="7865" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7867" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a><a id="7868" class="Symbol">)</a> <a id="7870" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="7872" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="7876" href="SMT.Script.Show.html#7840" class="Function">dropNameS</a> <a id="7886" class="Symbol">=</a> <a id="7888" class="Keyword">do</a>
    <a id="7895" class="Symbol">(</a><a id="7896" href="SMT.Script.Show.html#7896" class="Bound">ns</a> <a id="7899" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7901" class="Symbol">_</a> <a id="7903" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="7905" href="SMT.Script.Show.html#7905" class="Bound">vps</a><a id="7908" class="Symbol">)</a> <a id="7910" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7912" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="7920" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="7924" class="Symbol">(</a><a id="7925" href="SMT.Script.Names.html#2901" class="Function">dropName</a> <a id="7934" href="SMT.Script.Show.html#7896" class="Bound">ns</a> <a id="7937" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7939" href="SMT.Script.Show.html#7905" class="Bound">vps</a><a id="7942" class="Symbol">)</a>
    <a id="7948" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7955" class="Symbol">_</a>

  <a id="7960" href="SMT.Script.Show.html#7960" class="Function">lookupNameS</a> <a id="7972" class="Symbol">:</a> <a id="7974" class="Symbol">(</a><a id="7975" href="SMT.Script.Show.html#7975" class="Bound">i</a> <a id="7977" class="Symbol">:</a> <a id="7979" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="7981" href="SMT.Script.Base.html#2611" class="Function Operator">∋</a> <a id="7983" href="SMT.Script.Show.html#2076" class="Generalizable">σ</a><a id="7984" class="Symbol">)</a> <a id="7986" class="Symbol">→</a> <a id="7988" href="SMT.Script.Show.html#7089" class="Function">NameState</a> <a id="7998" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="8000" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="8002" href="SMT.Script.Names.html#1779" class="Function">Name</a>
  <a id="8009" href="SMT.Script.Show.html#7960" class="Function">lookupNameS</a> <a id="8021" href="SMT.Script.Show.html#8021" class="Bound">p</a> <a id="8023" class="Symbol">=</a> <a id="8025" class="Keyword">do</a>
    <a id="8032" class="Symbol">(</a><a id="8033" href="SMT.Script.Show.html#8033" class="Bound">ns</a> <a id="8036" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8038" href="SMT.Script.Show.html#8038" class="Bound Operator">_vps</a><a id="8042" class="Symbol">)</a> <a id="8044" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8046" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="8054" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8061" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8063" href="Data.Environment.html#849" class="Function">Env.lookup</a> <a id="8074" class="Symbol">(</a><a id="8075" href="SMT.Script.Names.html#2406" class="Field">Names.nameEnv</a> <a id="8089" href="SMT.Script.Show.html#8033" class="Bound">ns</a><a id="8091" class="Symbol">)</a> <a id="8093" class="Symbol">(</a><a id="8094" href="Data.List.Relation.Unary.Any.html#1817" class="Function">Any.index</a> <a id="8104" href="SMT.Script.Show.html#8021" class="Bound">p</a><a id="8105" class="Symbol">)</a>


  <a id="8111" class="Comment">-- * Printing functions</a>

  <a id="8138" class="Keyword">mutual</a>

    <a id="8150" class="Comment">-- |Show a term as an S-expression.</a>
    <a id="8190" href="SMT.Script.Show.html#8190" class="Function">showTermS</a> <a id="8200" class="Symbol">:</a> <a id="8202" href="SMT.Script.Base.html#3141" class="Datatype">Term</a> <a id="8207" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="8209" href="SMT.Script.Show.html#2076" class="Generalizable">σ</a> <a id="8211" class="Symbol">→</a> <a id="8213" href="SMT.Script.Show.html#7089" class="Function">NameState</a> <a id="8223" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="8225" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="8227" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
    <a id="8238" href="SMT.Script.Show.html#8190" class="Function">showTermS</a> <a id="8248" class="Symbol">(</a><a id="8249" href="SMT.Script.Base.html#3186" class="InductiveConstructor">`var</a> <a id="8254" href="SMT.Script.Show.html#8254" class="Bound">i</a><a id="8255" class="Symbol">)</a> <a id="8257" class="Symbol">=</a> <a id="8259" class="Keyword">do</a>
      <a id="8268" href="SMT.Script.Show.html#8268" class="Bound">n</a> <a id="8270" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8272" href="SMT.Script.Show.html#7960" class="Function">lookupNameS</a> <a id="8284" href="SMT.Script.Show.html#8254" class="Bound">i</a>
      <a id="8292" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8299" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8301" href="SMT.Script.Names.html#1825" class="Function">showName</a> <a id="8310" href="SMT.Script.Show.html#8268" class="Bound">n</a>
    <a id="8316" href="SMT.Script.Show.html#8190" class="Function">showTermS</a> <a id="8326" class="Symbol">(</a><a id="8327" href="SMT.Script.Base.html#3236" class="InductiveConstructor">`lit</a> <a id="8332" href="SMT.Script.Show.html#8332" class="Bound">l</a><a id="8333" class="Symbol">)</a> <a id="8335" class="Symbol">=</a> <a id="8337" class="Keyword">do</a>
      <a id="8346" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8353" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8355" href="SMT.Theory.Class.Printable.html#772" class="Function">showLiteral</a> <a id="8367" href="SMT.Script.Show.html#8332" class="Bound">l</a>
    <a id="8373" href="SMT.Script.Show.html#8190" class="Function">showTermS</a> <a id="8383" class="Symbol">(</a><a id="8384" href="SMT.Script.Base.html#3290" class="InductiveConstructor">`app</a> <a id="8389" href="SMT.Script.Show.html#8389" class="Bound">x</a> <a id="8391" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a><a id="8393" class="Symbol">)</a> <a id="8395" class="Symbol">=</a> <a id="8397" class="Keyword">do</a>
      <a id="8406" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8413" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8415" href="SMT.Theory.Class.Printable.html#825" class="Function">showIdentifier</a> <a id="8430" href="SMT.Script.Show.html#8389" class="Bound">x</a>
    <a id="8436" href="SMT.Script.Show.html#8190" class="CatchallClause Function">showTermS</a><a id="8445" class="CatchallClause"> </a><a id="8446" class="CatchallClause Symbol">(</a><a id="8447" href="SMT.Script.Base.html#3290" class="CatchallClause InductiveConstructor">`app</a><a id="8451" class="CatchallClause"> </a><a id="8452" href="SMT.Script.Show.html#8452" class="CatchallClause Bound">x</a><a id="8453" class="CatchallClause"> </a><a id="8454" href="SMT.Script.Show.html#8454" class="CatchallClause Bound">xs</a><a id="8456" class="CatchallClause Symbol">)</a> <a id="8458" class="Symbol">=</a> <a id="8460" class="Keyword">do</a>
      <a id="8469" class="Keyword">let</a> <a id="8473" href="SMT.Script.Show.html#8473" class="Bound">x</a> <a id="8475" class="Symbol">=</a> <a id="8477" href="SMT.Theory.Class.Printable.html#825" class="Function">showIdentifier</a> <a id="8492" href="SMT.Script.Show.html#8452" class="Bound">x</a>
      <a id="8500" href="SMT.Script.Show.html#8500" class="Bound">xs</a> <a id="8503" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8505" href="SMT.Script.Show.html#9159" class="Function">showArgsS</a> <a id="8515" href="SMT.Script.Show.html#8454" class="Bound">xs</a>
      <a id="8524" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8531" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8533" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="8541" class="Symbol">(</a><a id="8542" href="SMT.Script.Show.html#8473" class="Bound">x</a> <a id="8544" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8546" href="SMT.Script.Show.html#8500" class="Bound">xs</a><a id="8548" class="Symbol">)</a>
    <a id="8554" href="SMT.Script.Show.html#8190" class="Function">showTermS</a> <a id="8564" class="Symbol">(</a><a id="8565" href="SMT.Script.Base.html#3392" class="InductiveConstructor">`forall</a> <a id="8573" href="SMT.Script.Show.html#8573" class="Bound">n</a> <a id="8575" href="SMT.Script.Show.html#8575" class="Bound">σ</a> <a id="8577" href="SMT.Script.Show.html#8577" class="Bound">x</a><a id="8578" class="Symbol">)</a> <a id="8580" class="Symbol">=</a> <a id="8582" class="Keyword">do</a>
      <a id="8591" href="SMT.Script.Show.html#8591" class="Bound">n′</a> <a id="8594" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8596" href="SMT.Script.Show.html#7602" class="Function">freshNameS</a> <a id="8607" href="SMT.Script.Show.html#8573" class="Bound">n</a> <a id="8609" href="SMT.Script.Show.html#8575" class="Bound">σ</a>
      <a id="8617" href="SMT.Script.Show.html#8617" class="Bound">x</a> <a id="8619" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8621" href="SMT.Script.Show.html#8190" class="Function">showTermS</a> <a id="8631" href="SMT.Script.Show.html#8577" class="Bound">x</a>
      <a id="8639" href="SMT.Script.Show.html#7840" class="Function">dropNameS</a>
      <a id="8655" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8662" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8664" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="8672" class="Symbol">(</a><a id="8673" class="String">&quot;forall&quot;</a> <a id="8682" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8684" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="8692" class="Symbol">(</a><a id="8693" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="8701" class="Symbol">(</a><a id="8702" href="SMT.Script.Names.html#1825" class="Function">showName</a> <a id="8711" href="SMT.Script.Show.html#8591" class="Bound">n′</a> <a id="8714" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8716" href="SMT.Theory.Class.Printable.html#737" class="Function">showSort</a> <a id="8725" href="SMT.Script.Show.html#8575" class="Bound">σ</a> <a id="8727" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8729" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8731" class="Symbol">)</a> <a id="8733" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8735" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8737" class="Symbol">)</a> <a id="8739" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8741" href="SMT.Script.Show.html#8617" class="Bound">x</a> <a id="8743" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8745" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8747" class="Symbol">)</a>
    <a id="8753" href="SMT.Script.Show.html#8190" class="Function">showTermS</a> <a id="8763" class="Symbol">(</a><a id="8764" href="SMT.Script.Base.html#3477" class="InductiveConstructor">`exists</a> <a id="8772" href="SMT.Script.Show.html#8772" class="Bound">n</a> <a id="8774" href="SMT.Script.Show.html#8774" class="Bound">σ</a> <a id="8776" href="SMT.Script.Show.html#8776" class="Bound">x</a><a id="8777" class="Symbol">)</a> <a id="8779" class="Symbol">=</a> <a id="8781" class="Keyword">do</a>
      <a id="8790" href="SMT.Script.Show.html#8790" class="Bound">n′</a> <a id="8793" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8795" href="SMT.Script.Show.html#7602" class="Function">freshNameS</a> <a id="8806" href="SMT.Script.Show.html#8772" class="Bound">n</a> <a id="8808" href="SMT.Script.Show.html#8774" class="Bound">σ</a>
      <a id="8816" href="SMT.Script.Show.html#8816" class="Bound">x</a> <a id="8818" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8820" href="SMT.Script.Show.html#8190" class="Function">showTermS</a> <a id="8830" href="SMT.Script.Show.html#8776" class="Bound">x</a>
      <a id="8838" href="SMT.Script.Show.html#7840" class="Function">dropNameS</a>
      <a id="8854" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8861" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8863" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="8871" class="Symbol">(</a><a id="8872" class="String">&quot;exists&quot;</a> <a id="8881" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8883" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="8891" class="Symbol">(</a><a id="8892" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="8900" class="Symbol">(</a><a id="8901" href="SMT.Script.Names.html#1825" class="Function">showName</a> <a id="8910" href="SMT.Script.Show.html#8790" class="Bound">n′</a> <a id="8913" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8915" href="SMT.Theory.Class.Printable.html#737" class="Function">showSort</a> <a id="8924" href="SMT.Script.Show.html#8774" class="Bound">σ</a> <a id="8926" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8928" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8930" class="Symbol">)</a> <a id="8932" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8934" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8936" class="Symbol">)</a> <a id="8938" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8940" href="SMT.Script.Show.html#8816" class="Bound">x</a> <a id="8942" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8944" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8946" class="Symbol">)</a>
    <a id="8952" href="SMT.Script.Show.html#8190" class="Function">showTermS</a> <a id="8962" class="Symbol">(</a><a id="8963" href="SMT.Script.Base.html#3562" class="InductiveConstructor">`let</a> <a id="8968" href="SMT.Script.Show.html#8968" class="Bound">n</a> <a id="8970" href="SMT.Script.Show.html#8970" class="Bound">σ</a> <a id="8972" href="SMT.Script.Show.html#8972" class="Bound">x</a> <a id="8974" href="SMT.Script.Show.html#8974" class="Bound">y</a><a id="8975" class="Symbol">)</a> <a id="8977" class="Symbol">=</a> <a id="8979" class="Keyword">do</a>
      <a id="8988" href="SMT.Script.Show.html#8988" class="Bound">x</a> <a id="8990" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8992" href="SMT.Script.Show.html#8190" class="Function">showTermS</a> <a id="9002" href="SMT.Script.Show.html#8972" class="Bound">x</a>
      <a id="9010" href="SMT.Script.Show.html#9010" class="Bound">n</a> <a id="9012" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9014" href="SMT.Script.Show.html#7602" class="Function">freshNameS</a> <a id="9025" href="SMT.Script.Show.html#8968" class="Bound">n</a> <a id="9027" href="SMT.Script.Show.html#8970" class="Bound">σ</a>
      <a id="9035" href="SMT.Script.Show.html#9035" class="Bound">y</a> <a id="9037" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9039" href="SMT.Script.Show.html#8190" class="Function">showTermS</a> <a id="9049" href="SMT.Script.Show.html#8974" class="Bound">y</a>
      <a id="9057" href="SMT.Script.Show.html#7840" class="Function">dropNameS</a>
      <a id="9073" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9080" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9082" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="9090" class="Symbol">((</a><a id="9092" class="String">&quot;let&quot;</a> <a id="9098" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9100" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="9108" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="9110" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="9118" class="Symbol">(</a><a id="9119" href="SMT.Script.Names.html#1825" class="Function">showName</a> <a id="9128" href="SMT.Script.Show.html#9010" class="Bound">n</a> <a id="9130" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9132" href="SMT.Script.Show.html#8988" class="Bound">x</a> <a id="9134" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9136" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9138" class="Symbol">)</a> <a id="9140" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="9142" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9144" href="SMT.Script.Show.html#9035" class="Bound">y</a> <a id="9146" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9148" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9150" class="Symbol">)</a> <a id="9152" class="Symbol">)</a>

    <a id="9159" href="SMT.Script.Show.html#9159" class="Function">showArgsS</a> <a id="9169" class="Symbol">:</a> <a id="9171" href="SMT.Script.Base.html#3649" class="Function">Args</a> <a id="9176" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="9178" href="SMT.Script.Show.html#2114" class="Generalizable">Δ</a> <a id="9180" class="Symbol">→</a> <a id="9182" href="SMT.Script.Show.html#7089" class="Function">NameState</a> <a id="9192" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="9194" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="9196" class="Symbol">(</a><a id="9197" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="9202" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="9208" class="Symbol">)</a>
    <a id="9214" href="SMT.Script.Show.html#9159" class="Function">showArgsS</a> <a id="9224" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a>       <a id="9233" class="Symbol">=</a> <a id="9235" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9242" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="9249" href="SMT.Script.Show.html#9159" class="Function">showArgsS</a> <a id="9259" class="Symbol">(</a><a id="9260" href="SMT.Script.Show.html#9260" class="Bound">x</a> <a id="9262" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">∷</a> <a id="9264" href="SMT.Script.Show.html#9264" class="Bound">xs</a><a id="9266" class="Symbol">)</a> <a id="9268" class="Symbol">=</a> <a id="9270" class="Keyword">do</a> <a id="9273" href="SMT.Script.Show.html#9273" class="Bound">x</a> <a id="9275" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9277" href="SMT.Script.Show.html#8190" class="Function">showTermS</a> <a id="9287" href="SMT.Script.Show.html#9260" class="Bound">x</a><a id="9288" class="Symbol">;</a> <a id="9290" href="SMT.Script.Show.html#9290" class="Bound">xs</a> <a id="9293" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9295" href="SMT.Script.Show.html#9159" class="Function">showArgsS</a> <a id="9305" href="SMT.Script.Show.html#9264" class="Bound">xs</a><a id="9307" class="Symbol">;</a> <a id="9309" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9316" class="Symbol">(</a><a id="9317" href="SMT.Script.Show.html#9273" class="Bound">x</a> <a id="9319" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9321" href="SMT.Script.Show.html#9290" class="Bound">xs</a><a id="9323" class="Symbol">)</a>

  <a id="9328" class="Comment">-- |Show a script as an S-expression, and build up an environment of output parsers.</a>
  <a id="9415" href="SMT.Script.Show.html#9415" class="Function">showScriptS</a> <a id="9427" class="Symbol">:</a> <a id="9429" href="SMT.Script.Base.html#9148" class="Datatype">Script</a> <a id="9436" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="9438" href="SMT.Script.Show.html#2097" class="Generalizable">Γ′</a> <a id="9441" href="SMT.Script.Show.html#2211" class="Generalizable">Ξ</a> <a id="9443" class="Symbol">→</a> <a id="9445" href="SMT.Script.Show.html#7089" class="Function">NameState</a> <a id="9455" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="9457" href="SMT.Script.Show.html#2097" class="Generalizable">Γ′</a> <a id="9460" class="Symbol">(</a><a id="9461" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="9466" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="9473" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="9475" href="SMT.Script.Show.html#2974" class="Function">OutputParsers</a> <a id="9489" href="SMT.Script.Show.html#2211" class="Generalizable">Ξ</a><a id="9490" class="Symbol">)</a>
  <a id="9494" href="SMT.Script.Show.html#9415" class="Function">showScriptS</a> <a id="9506" href="SMT.Script.Base.html#9211" class="InductiveConstructor">[]</a> <a id="9509" class="Symbol">=</a> <a id="9511" class="Keyword">do</a>
    <a id="9518" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9525" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9527" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="9530" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9532" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="9537" href="SMT.Script.Show.html#9415" class="Function">showScriptS</a> <a id="9549" class="Symbol">(</a><a id="9550" href="SMT.Script.Base.html#9244" class="InductiveConstructor">`set-logic</a> <a id="9561" href="SMT.Script.Show.html#9561" class="Bound">l</a> <a id="9563" href="SMT.Script.Show.html#9563" class="Bound">scr</a><a id="9566" class="Symbol">)</a> <a id="9568" class="Symbol">=</a> <a id="9570" class="Keyword">do</a>
    <a id="9577" class="Symbol">(</a><a id="9578" href="SMT.Script.Show.html#9578" class="Bound">scr</a> <a id="9582" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9584" href="SMT.Script.Show.html#9584" class="Bound">ops</a><a id="9587" class="Symbol">)</a> <a id="9589" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9591" href="SMT.Script.Show.html#9415" class="Function">showScriptS</a> <a id="9603" href="SMT.Script.Show.html#9563" class="Bound">scr</a>
    <a id="9611" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9618" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9620" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="9628" class="Symbol">(</a><a id="9629" class="String">&quot;set-logic&quot;</a> <a id="9641" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9643" href="SMT.Script.Show.html#9561" class="Bound">l</a> <a id="9645" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9647" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9649" class="Symbol">)</a> <a id="9651" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9653" href="SMT.Script.Show.html#9578" class="Bound">scr</a> <a id="9657" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9659" href="SMT.Script.Show.html#9584" class="Bound">ops</a>
  <a id="9665" href="SMT.Script.Show.html#9415" class="Function">showScriptS</a> <a id="9677" class="Symbol">(</a><a id="9678" href="SMT.Script.Base.html#9307" class="InductiveConstructor">`declare-const</a> <a id="9693" href="SMT.Script.Show.html#9693" class="Bound">n</a> <a id="9695" href="SMT.Script.Show.html#9695" class="Bound">σ</a> <a id="9697" href="SMT.Script.Show.html#9697" class="Bound">scr</a><a id="9700" class="Symbol">)</a> <a id="9702" class="Symbol">=</a> <a id="9704" class="Keyword">do</a>
    <a id="9711" href="SMT.Script.Show.html#9711" class="Bound">n′</a> <a id="9714" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9716" href="SMT.Script.Show.html#7602" class="Function">freshNameS</a> <a id="9727" href="SMT.Script.Show.html#9693" class="Bound">n</a> <a id="9729" href="SMT.Script.Show.html#9695" class="Bound">σ</a>
    <a id="9735" class="Symbol">(</a><a id="9736" href="SMT.Script.Show.html#9736" class="Bound">scr</a> <a id="9740" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9742" href="SMT.Script.Show.html#9742" class="Bound">ops</a><a id="9745" class="Symbol">)</a> <a id="9747" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9749" href="SMT.Script.Show.html#9415" class="Function">showScriptS</a> <a id="9761" href="SMT.Script.Show.html#9697" class="Bound">scr</a>
    <a id="9769" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9776" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9778" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="9786" class="Symbol">(</a><a id="9787" class="String">&quot;declare-const&quot;</a> <a id="9803" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9805" href="SMT.Script.Names.html#1825" class="Function">showName</a> <a id="9814" href="SMT.Script.Show.html#9711" class="Bound">n′</a> <a id="9817" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9819" href="SMT.Theory.Class.Printable.html#737" class="Function">showSort</a> <a id="9828" href="SMT.Script.Show.html#9695" class="Bound">σ</a> <a id="9830" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9832" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9834" class="Symbol">)</a> <a id="9836" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9838" href="SMT.Script.Show.html#9736" class="Bound">scr</a> <a id="9842" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9844" href="SMT.Script.Show.html#9742" class="Bound">ops</a>
  <a id="9850" href="SMT.Script.Show.html#9415" class="Function">showScriptS</a> <a id="9862" class="Symbol">(</a><a id="9863" href="SMT.Script.Base.html#9388" class="InductiveConstructor">`assert</a> <a id="9871" href="SMT.Script.Show.html#9871" class="Bound">x</a> <a id="9873" href="SMT.Script.Show.html#9873" class="Bound">scr</a><a id="9876" class="Symbol">)</a> <a id="9878" class="Symbol">=</a> <a id="9880" class="Keyword">do</a>
    <a id="9887" href="SMT.Script.Show.html#9887" class="Bound">x</a> <a id="9889" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9891" href="SMT.Script.Show.html#8190" class="Function">showTermS</a> <a id="9901" href="SMT.Script.Show.html#9871" class="Bound">x</a>
    <a id="9907" class="Symbol">(</a><a id="9908" href="SMT.Script.Show.html#9908" class="Bound">scr</a> <a id="9912" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9914" href="SMT.Script.Show.html#9914" class="Bound">ops</a><a id="9917" class="Symbol">)</a> <a id="9919" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9921" href="SMT.Script.Show.html#9415" class="Function">showScriptS</a> <a id="9933" href="SMT.Script.Show.html#9873" class="Bound">scr</a>
    <a id="9941" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9948" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9950" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="9958" class="Symbol">(</a><a id="9959" class="String">&quot;assert&quot;</a> <a id="9968" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9970" href="SMT.Script.Show.html#9887" class="Bound">x</a> <a id="9972" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9974" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9976" class="Symbol">)</a> <a id="9978" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9980" href="SMT.Script.Show.html#9908" class="Bound">scr</a> <a id="9984" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9986" href="SMT.Script.Show.html#9914" class="Bound">ops</a>
  <a id="9992" href="SMT.Script.Show.html#9415" class="Function">showScriptS</a> <a id="10004" class="Symbol">(</a><a id="10005" href="SMT.Script.Base.html#9451" class="InductiveConstructor">`check-sat</a> <a id="10016" href="SMT.Script.Show.html#10016" class="Bound">scr</a><a id="10019" class="Symbol">)</a> <a id="10021" class="Symbol">=</a> <a id="10023" class="Keyword">do</a>
    <a id="10030" class="Symbol">(</a><a id="10031" href="SMT.Script.Show.html#10031" class="Bound">scr</a> <a id="10035" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10037" href="SMT.Script.Show.html#10037" class="Bound">ops</a><a id="10040" class="Symbol">)</a> <a id="10042" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="10044" href="SMT.Script.Show.html#9415" class="Function">showScriptS</a> <a id="10056" href="SMT.Script.Show.html#10016" class="Bound">scr</a>
    <a id="10064" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="10071" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="10073" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="10081" class="Symbol">(</a><a id="10082" class="String">&quot;check-sat&quot;</a> <a id="10094" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10096" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="10098" class="Symbol">)</a> <a id="10100" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10102" href="SMT.Script.Show.html#10031" class="Bound">scr</a> <a id="10106" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10108" href="SMT.Script.Show.html#3099" class="Function">pSat</a> <a id="10113" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="10115" href="SMT.Script.Show.html#10037" class="Bound">ops</a>
  <a id="10121" href="SMT.Script.Show.html#9415" class="Function">showScriptS</a> <a id="10133" class="Symbol">(</a><a id="10134" href="SMT.Script.Base.html#9508" class="InductiveConstructor">`get-model</a> <a id="10145" href="SMT.Script.Show.html#10145" class="Bound">scr</a><a id="10148" class="Symbol">)</a> <a id="10150" class="Symbol">=</a> <a id="10152" class="Keyword">do</a>
    <a id="10159" class="Symbol">(</a><a id="10160" href="SMT.Script.Show.html#10160" class="Bound Operator">_ns</a> <a id="10164" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10166" href="SMT.Script.Show.html#10166" class="Bound">vps</a><a id="10169" class="Symbol">)</a> <a id="10171" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="10173" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="10181" class="Symbol">(</a><a id="10182" href="SMT.Script.Show.html#10182" class="Bound">scr</a> <a id="10186" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10188" href="SMT.Script.Show.html#10188" class="Bound">ops</a><a id="10191" class="Symbol">)</a> <a id="10193" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="10195" href="SMT.Script.Show.html#9415" class="Function">showScriptS</a> <a id="10207" href="SMT.Script.Show.html#10145" class="Bound">scr</a>
    <a id="10215" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="10222" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="10224" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="10232" class="Symbol">(</a><a id="10233" class="String">&quot;check-sat&quot;</a> <a id="10245" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10247" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="10249" class="Symbol">)</a> <a id="10251" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10253" href="SMT.Theory.Class.Printable.html#1080" class="Function">mkSTerm</a> <a id="10261" class="Symbol">(</a><a id="10262" class="String">&quot;get-model&quot;</a> <a id="10274" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10276" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="10278" class="Symbol">)</a> <a id="10280" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10282" href="SMT.Script.Show.html#10182" class="Bound">scr</a>
           <a id="10297" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10299" href="SMT.Script.Show.html#5549" class="Function">mkModelParser</a> <a id="10313" class="Symbol">(</a><a id="10314" href="SMT.Script.Show.html#2528" class="Function">mkVarParser</a> <a id="10326" href="SMT.Script.Show.html#10166" class="Bound">vps</a><a id="10329" class="Symbol">)</a> <a id="10331" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="10333" href="SMT.Script.Show.html#10188" class="Bound">ops</a>

  <a id="10340" class="Comment">-- |Show a script as an S-expression, and return an environment of output parsers.</a>
  <a id="10425" href="SMT.Script.Show.html#10425" class="Function">showScript</a> <a id="10436" class="Symbol">:</a> <a id="10438" href="SMT.Script.Base.html#9148" class="Datatype">Script</a> <a id="10445" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="10448" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="10450" href="SMT.Script.Show.html#2211" class="Generalizable">Ξ</a> <a id="10452" class="Symbol">→</a> <a id="10454" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="10461" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="10463" class="Symbol">(</a><a id="10464" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="10471" class="Symbol">→</a> <a id="10473" href="Text.Parser.Position.html#380" class="Record">Position</a> <a id="10482" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="10484" class="Symbol">(</a><a id="10485" href="SMT.Script.Base.html#7142" class="Datatype">Outputs</a> <a id="10493" href="SMT.Script.Show.html#2211" class="Generalizable">Ξ</a><a id="10494" class="Symbol">))</a>
  <a id="10499" href="SMT.Script.Show.html#10425" class="Function">showScript</a> <a id="10510" href="SMT.Script.Show.html#10510" class="Bound">scr</a> <a id="10514" class="Symbol">=</a> <a id="10516" href="Data.Product.html#2486" class="Function">Prod.map</a> <a id="10525" href="Data.String.Base.html#2767" class="Function">String.unlines</a> <a id="10540" href="SMT.Script.Show.html#6688" class="Function">mkOutputParsers</a> <a id="10556" class="Symbol">(</a><a id="10557" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="10563" class="Symbol">(</a><a id="10564" href="SMT.Script.Show.html#9415" class="Function">showScriptS</a> <a id="10576" href="SMT.Script.Show.html#10510" class="Bound">scr</a> <a id="10580" class="Symbol">(</a><a id="10581" href="SMT.Script.Names.html#3120" class="Function">x′es</a> <a id="10586" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10588" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="10590" class="Symbol">)))</a>

  <a id="10597" class="Comment">-- |Get the variable parser for a script (for debugging purposes).</a>
  <a id="10666" href="SMT.Script.Show.html#10666" class="Function">getVarParser</a> <a id="10679" class="Symbol">:</a> <a id="10681" href="SMT.Script.Base.html#9148" class="Datatype">Script</a> <a id="10688" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="10691" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="10693" href="SMT.Script.Show.html#2211" class="Generalizable">Ξ</a> <a id="10695" class="Symbol">→</a> <a id="10697" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="10700" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="10707" class="Symbol">(</a><a id="10708" href="Data.Product.html#1806" class="Function">∃[</a> <a id="10711" href="SMT.Script.Show.html#10711" class="Bound">σ</a> <a id="10713" href="Data.Product.html#1806" class="Function">]</a> <a id="10715" class="Symbol">(</a><a id="10716" href="SMT.Script.Show.html#2095" class="Generalizable">Γ</a> <a id="10718" href="SMT.Script.Base.html#2611" class="Function Operator">∋</a> <a id="10720" href="SMT.Script.Show.html#10711" class="Bound">σ</a><a id="10721" class="Symbol">))</a> <a id="10724" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="10728" href="SMT.Script.Show.html#10666" class="Function">getVarParser</a> <a id="10741" href="SMT.Script.Show.html#10741" class="Bound">scr</a> <a id="10745" class="Symbol">=</a> <a id="10747" href="SMT.Script.Show.html#2528" class="Function">mkVarParser</a> <a id="10759" class="Symbol">(</a><a id="10760" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="10766" class="Symbol">(</a><a id="10767" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="10773" class="Symbol">(</a><a id="10774" href="SMT.Script.Show.html#9415" class="Function">showScriptS</a> <a id="10786" href="SMT.Script.Show.html#10741" class="Bound">scr</a> <a id="10790" class="Symbol">(</a><a id="10791" href="SMT.Script.Names.html#3120" class="Function">x′es</a> <a id="10796" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10798" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="10800" class="Symbol">))))</a>
</pre></body></html>